{"version":3,"sources":["common/documents/table/Columns.js","common/Modal.jsx","common/documents/Selection.js","common/account/Avatar.jsx","common/documents/FiledropHint.jsx","common/documents/table/rows/TypeIcons.js","workspace/initialState.js","workspace/operations/ModalForm.jsx","workspace/operations/folder/index.js","common/Meter.jsx","workspace/operations/importing/ImportProgressModal.jsx","workspace/operations/importing/Importer.jsx","workspace/operations/importing/shine/SHINEModal.jsx","workspace/operations/importing/index.js","workspace/operations/ner/progress/NERProgressModal.jsx","workspace/operations/ner/configuration/authorities/AuthoritySelection.jsx","workspace/operations/ner/configuration/engines/EngineSelection.jsx","workspace/operations/ner/configuration/NERConfigurationModal.jsx","workspace/operations/ner/EntityRecognition.jsx","workspace/operations/mapkurator/MapKurator.jsx","workspace/operations/readme/index.js","workspace/operations/move/FolderBrowser.jsx","workspace/operations/prompt.js","workspace/operations/alert.js","workspace/operations/sharing/public/PublicAccess.jsx","workspace/operations/sharing/collaborators/PermissionSelector.js","common/UserSearch.jsx","workspace/operations/sharing/collaborators/Collaborators.jsx","workspace/operations/sharing/copies/DistributeCopies.jsx","workspace/operations/sharing/ShareModal.jsx","workspace/operations/network/NetworkModal.js","workspace/operations/index.js","workspace/operations/importing/shine/index.js","workspace/operations/selection/index.js","workspace/operations/move/index.js","workspace/operations/sharing/index.js","workspace/operations/network/index.js","workspace/operations/ner/index.js","workspace/operations/mapkurator/index.js","common/Menu.jsx","workspace/header/search/AdvancedSearch.jsx","workspace/header/search/Search.jsx","workspace/header/Header.jsx","workspace/sidebar/sections/Account.jsx","workspace/sidebar/sections/NewContent.jsx","workspace/sidebar/sections/Views.jsx","workspace/sidebar/sections/Storage.jsx","workspace/sidebar/sections/MyActivity.jsx","workspace/sidebar/Sidebar.jsx","workspace/Workspace.jsx","workspace/App.jsx","common/header/HeaderIcon.jsx","common/header/Breadcrumbs.jsx","common/documents/Readme.jsx","common/account/IdentityInfo.jsx","common/account/ActivityHistory.jsx","common/account/TopCollaborators.jsx","common/documents/table/rows/BaseRowComponent.jsx","common/documents/table/rows/DocumentRow.jsx","common/documents/table/rows/FolderRow.jsx","common/documents/table/rows/HeaderRow.jsx","common/documents/table/preferences/ColumnOrder.jsx","common/documents/table/preferences/PreferencesModal.jsx","common/documents/table/TablePane.jsx","common/documents/grid/Document.jsx","common/documents/grid/Folder.jsx","common/documents/grid/GridPane.jsx"],"names":["COLUMNS_SHARED_WITH_ME","COLUMNS","concat","HEADER_NAMES","author","title","language","date_freeform","uploaded_at","last_edit_at","last_edit_by","my_last_edit_at","annotations","my_annotations","public_visibility","status_ratio","cloned_from","has_clones","owner","shared_by","access_level","COLUMN_WIDTH","agg_document","AGGREGATE_COLUMNS","Columns","Object","_home_simonr_Workspaces_pelagios_recogito2_workspace_frontend_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","this","_home_simonr_Workspaces_pelagios_recogito2_workspace_frontend_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__","key","value","field","w","columns","reduce","result","startsWith","push","view","filter","c","includes","Modal","react__WEBPACK_IMPORTED_MODULE_5___default","a","createElement","className","props","react_draggable__WEBPACK_IMPORTED_MODULE_6___default","handle","onClick","onClose","children","Component","Selection","selectedItems","_this","selectItem","item","isCtrlPressed","thisIdx","_selection","indexOf","isSelected","cloned","slice","splice","selectRange","allItems","toIdx","selectedIndices","map","minIdx","Math","min","apply","maxIdx","max","isOutside","from","to","length","type","filetypes","find","ft","idx","i","evt","isShift","getModifierState","isCtrl","newSelection","preventDefault","Avatar","str","hash","charCodeAt","color","username","stringToHslColor","style","backgroundColor","charAt","toUpperCase","AnimatedDiv","posed","div","open","bottom","transition","ease","duration","closed","FiledropHint","state","visible","setState","pose","ICONS","TEXT_PLAIN","TEXT_TEIXML","IMAGE_UPLOAD","IMAGE_IIIF","DATA_CSV","MAP_WMTS","MAP_XYZ","TypeIcons","get","docType","DEFAULT_STATE","account","presentation","search_scope","page","breadcrumbs","readme","total_count","items","selection","table_config","sorting","by","asc","busy","initialState","stored","localStorage","getItem","JSON","parse","objectSpread","persistState","prefixed","setItem","stringify","ModalForm","handleKeydown","which","onCancel","document","addEventListener","removeEventListener","react_default","onOk","CreateFolderForm","folderName","onChange","target","onKeyPress","ModalForm_ModalForm","autoFocus","placeholder","Meter","position","width","height","FileProgress","upload","file","name","status","ImportProgressModal","totalLoaded","uploads","total","u","progress","errors","error","phase","ImportProgressModal_FileProgress","join","Meter_Meter","totalSize","Uploader","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","updateUploadState","diff","prev","initNewDocument","formdata","FormData","append","axios","post","headers","X-Requested-With","uploadFiles","requests","uploadId","onUploadProgress","loaded","then","filepartId","data","uuid","catch","response","Promise","all","finalizeDocument","withError","currentFolder","location","substring","url","tasks","running_tasks","pollTaskProgress","document_id","forEach","onComplete","documentId","taskTypes","subtasks","t","filepart_id","isComplete","setTimeout","start","files","f","size","remoteSource","sourceType","_this2","id","importRemoteSource","importing_ImportProgressModal","SHINEModal","SHINEFileUpload","convertedFiles","newFile","File","content","onUploadFiles","handleSHINEModalClick","e","styles","shineModal","shineBrowserContainer","index_es","primary","borderRadius","fontFamily","text","close","handleFileUpload","zIndex","top","left","right","display","alignItems","justifyContent","maxHeight","maxWidth","margin","boxShadow","URLInputForm","onDrop","dataTransfer","getData","importContent","resolve","container","body","appendChild","render","Importer_Uploader","remove","NERProgressModal","tasksCompleted","pollProgress","jobId","tasksFailed","isDone","AuthoritySelection","identifier","selected","currentIdx","checked","useAll","onToggleAll","htmlFor","authorities","authority","bind","homepage","href","rel","shortname","fullname","EngineSelection","cellSpacing","engines","engine","Fragment","group","languages","lang","description","NERModal","available_engines","available_authorities","selected_engine","selected_all_authorities","selected_authorities","initAvailableAuthorities","initAvailableEngines","_this3","all_authorities","onStart","EngineSelection_EngineSelection","changeEngine","AuthoritySelection_AuthoritySelection","toggleAllAuthorities","changeAuthorities","EntityRecognition","running","config","textDocuments","getItems","isDocument","hasTextParts","taskDefinition","task_type","documents","d","job_id","NERProgressModal_NERProgressModal","NERConfigurationModal_NERModal","MapKurator","complete","message","getUrl","currentFolderId","TITLES","MY_DOCUMENTS","SHARED_WITH_ME","FolderItem","onSelect","has_subfolders","onNavigateInto","DisabledDocumentItem","src","Icons","alt","FolderBrowser","pageToState","b","parent","select","goToFolder","goToViewsOverview","navigateUp","navigateInto","folderId","stopPropagation","move","destination","getDocuments","folders","getFolders","fDocs","put","action","fFolders","FolderBrowser_DisabledDocumentItem","FolderBrowser_FolderItem","react_draggable_default","ReactCSSTransitionReplace_default","transitionName","transitionEnterTimeout","transitionLeaveTimeout","disabled","Prompt","onKeydown","onNo","toLowerCase","onYes","prompt","promptRoot","setAttribute","prompt_Prompt","onConfirm","Alert","PublicAccess","visibility","updateSetting","update","ids","onChangeVisibility","onChangeAccessLevel","_result$data","PermissionSelector","onMousedown","_node","contains","handleCancel","level","onChangeLevel","ref","n","changeLevel","accessLevel","UserSearch","isLoading","options","inputValue","fetchSuggestions","query","exclude","onInputChange","clear","_input","getInstance","onKeyDown","_this$state","lib","r","onSearch","Collaborators","collaborators","storeCollaborator","setting","openPermissionsSelector","collaborator","root","PermissionSelector_PermissionSelector","openSelector","nodeName","parentNode","removeCollaborator","delete","addCollaborator","toConsumableArray","UserSearch_UserSearch","DistributeCopies","recipients","removeRecipient","recipient","addRecipient","sendCopies","ShareModal","setView","getView","PublicAccess_PublicAccess","Collaborators_Collaborators","DistributeCopies_DistributeCopies","NetworkTreeNode","edits_since","merge","onMergeComplete","cloned_at","encodeURIComponent","contributions","feature_toggles","doc","assign","NetworkModal","network","_this4","_this5","docId","NetworkModal_NetworkTreeNode","operations","createFolder","folder_CreateFolderForm","renameFolder","folder","importSource","typ","endsWith","identifySource","onResolve","shine_SHINEModal","done","importing_URLInputForm","updateReadme","currentPageState","deleteReadme","deleteSelection","args","onSuccess","onError","deleteDocuments","deleteFolders","moveSelection","FolderBrowser_FolderBrowser","duplicateSelection","isSingleDocument","alert_Alert","alert","shareSelection","ShareModal_ShareModal","exploreNetwork","NetworkModal_NetworkModal","entityRecognition","EntityRecognition_EntityRecognition","mapKurator","MapKurator_MapKurator","Menu","assertThisInitialized","Group","classNames","Item","label","link","icon","INITIAL_STATE","in","lastModified","AdvancedSearch","onChangeSearchIn","onChangeDocType","onChangeOwner","onChangeQuery","onChangeLastModified","onClear","isClickOutside","isClickOnToggle","classList","searchIn","SCOPE_NAMES","Search","searchScope","onQuit","toggleAdvancedSearch","advancedSearchOpen","executeSearch","tableConfig","onResponse","scope","q","advancedSearch","settings","_rootEl","getElementById","AdvancedSearch_AdvancedSearch","OptionsMenu","canDuplicate","canShare","isSingleFolder","hasNetwork","common_Menu","isSingleSelection","window","onMoveSelection","onDuplicateSelection","onDeleteSelection","onShareSelection","onExploreNetwork","includesText","onNER","onMapKurator","Header","optionsMenuVisible","showOptionsMenu","closeOptionsMenu","closeAndThen","fn","hasSelection","isEmpty","Search_Search","onSearchResponse","onQuitSearch","HeaderIcon","Breadcrumbs","path","docCount","onCreateReadme","react_transition_group","timeout","Header_OptionsMenu","onTogglePresentation","Account","menuVisible","openMenu","closeMenu","IdentityInfo","NewContent","onOpenMenu","onCloseMenu","onOpenFileExplorer","click","Array","hasFeature","hasAnyFeature","names","toggles","Set","has","multiple","onCreateFolder","onImportSource","ViewListItem","current","Views","Views_ViewListItem","onChangeView","Storage","dataAvailable","storage","quota","quota_mb","used","used_mb","number_format_default","displayType","thousandSeparator","MyActivity","ActivityHistory","fill","stats","TopCollaborators","Sidebar","Account_Account","NewContent_NewContent","sections_Views","sections_Storage","sections_MyActivity","Workspace","sidebar_Sidebar","Header_Header","Readme","onUpdate","onUpdateReadme","onDelete","onDeleteReadme","TablePane","enableFiledrop","onSort","onSortTable","onChangeColumnConfig","onRenameFolder","onDropFiles","onDropSourceURL","GridPane","App","querySelector","refreshPage","expandAggregatedColumns","sort","changeFolder","changeView","togglePresentation","sortTable","changeColumConfig","createReadme","onhashchange","workspace_Workspace","App_App","react__WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","react__WEBPACK_IMPORTED_MODULE_0___default","VIEW_LABELS","SEARCH","undefined","editing","modifiedContent","ctrlKey","onSave","_","react_markdown__WEBPACK_IMPORTED_MODULE_6___default","source","onEdit","react_sane_contenteditable__WEBPACK_IMPORTED_MODULE_7__","tagName","editable","multiLine","editOnOpen","renderEdit","renderView","replace","member_since","_Avatar_jsx__WEBPACK_IMPORTED_MODULE_6__","real_name","Intl","DateTimeFormat","year","month","day","format","Date","bio","website","formatURL","LINE_STYLE","stroke","strokeWidth","AXIS_STYLE","fontSize","tickFormatter","tick","toTimestamp","empty","arr","last","reverse","timestamp","toTime","getTime","createEmptySeries","timeseries","over_time","date","padTimeseries","react_number_format__WEBPACK_IMPORTED_MODULE_7___default","total_contributions","recharts__WEBPACK_IMPORTED_MODULE_6__","barCategoryGap","computeChart","strokeDasharray","horizontal","dataKey","axisLine","tickSize","tickCount","tickLine","domain","padding","fetchCollaborators","user","_Avatar_jsx__WEBPACK_IMPORTED_MODULE_7__","BaseRowComponent","updateTotalRowSpan","next","_totalSpan","getSpan","FORMATTERS","datetime","lib_default","ratio","verified","unverified","not_identifiable","pctGreen","pctYellow","labels","tooltip","count","clonedFrom","hasClones","AGGREGATE_FIELDS","DocumentRow","prototype","formatter","createAggregateField","createField","FolderRow","makeEditable","onRename","HeaderRow","sortColumn","sortAsc","SortableItem","SortableElement","_ref","SortableList","SortableContainer","_ref2","index","ColumnOrder","onSortEnd","oldIndex","newIndex","PreferencesModal","states","isChecked","toAppend","checkAll","setAllRows","arrayMove","onClickAll","toggleOne","ColumnOrder_ColumnOrder","drag","tablePreferencesOpen","showPreferences","onSavePreferences","sortBy","onDrag","active","hostname","FolderRow_FolderRow","onRowClick","DocumentRow_DocumentRow","handleClick","tablePane","es","rowCount","rowHeight","rowRenderer","HeaderRow_HeaderRow","dist_es","disableClick","onDragEnter","onDragLeave","PreferencesModal_PreferencesModal","Document","isStacked","fileCount","Folder","itemsPerRow","fromIndex","itemsInRow","renderedItems","rowIdx","Folder_Folder","onTileClick","Document_Document","file_count","gridPane","floor","ceil","disableFiledrop"],"mappings":"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","file":"static/js/workspace.e43ee11d.chunk.js","sourcesContent":["// Columns available in all views\nconst COLUMNS_GENERAL = [\n  // Aggregate fields\n  // 'agg_document',\n\n  // Common fields\n  'author',\n  'title',\n  'language',\n  'date_freeform',\n  'uploaded_at',\n  'last_edit_at',\n  'last_edit_by',\n  'my_last_edit_at',\n  'annotations',\n  'my_annotations',\n  'public_visibility',\n  'status_ratio',\n  'cloned_from',\n  'has_clones'\n];\n\n// Columns specific to SHARED_WITH_ME view\nconst COLUMNS_SHARED_WITH_ME = [\n  'owner',\n  'shared_by',\n  'access_level'\n];\n\nexport const COLUMNS = COLUMNS_GENERAL.concat(COLUMNS_SHARED_WITH_ME);\n\n// Labels to use for fields\nexport const HEADER_NAMES = {\n  // agg_document    : 'Document',\n\n  author            : 'Author',\n  title             : 'Title',\n  language          : 'Language',\n  date_freeform     : 'Date',\n  uploaded_at       : 'Uploaded at',\n  last_edit_at      : 'Last edit',\n  last_edit_by      : 'Last edit by',\n  my_last_edit_at   : 'My last edit',\n  annotations       : 'Annotations',\n  my_annotations    : 'My annotations',\n  public_visibility : 'Visibility',\n  status_ratio      : 'Verification ratio',\n  cloned_from       : 'Cloned from',\n  has_clones        : 'Has clones',\n\n  owner             : 'Document owner',\n  shared_by         : 'Shared by',\n  access_level      : 'Access'\n};\n\n// Relative width requirements per column (XL, L, M, S)\nexport const COLUMN_WIDTH = {\n  agg_document    : 'XL',\n\n  author            : 'M',\n  title             : 'L',\n  language          : 'M',\n  date_freeform     : 'M',\n  uploaded_at       : 'M',\n  last_edit_at      : 'M',\n  last_edit_by      : 'M',\n  my_last_edit_at   : 'M',\n  annotations       : 'M',\n  my_annotations    : 'M',\n  public_visibility : 'M',\n  status_ratio      : 'M',\n  cloned_from       : 'M',\n  has_clones        : 'S',\n\n  owner             : 'M',\n  shared_by         : 'M',\n  access_level      : 'M'\n};\n\nexport const AGGREGATE_COLUMNS = {\n  agg_document: [ 'author', 'document' ]\n};\n\n// Static helper methods \nexport class Columns {\n\n  static getSpan(field) {\n    const w = COLUMN_WIDTH[field];\n    if (w === 'XL') \n      return 6;\n    else if (w === 'L')\n      return 4;\n    else if (w === 'M')\n      return 2;\n    else if (w === 'S')\n      return 1;\n  }\n\n  /** Expands agg_ columns to those that are required to build them **/\n  static expandAggregatedColumns(columns) {\n    return columns.reduce((result, field) => {\n      if (field.startsWith('agg_'))\n        result = result.concat(AGGREGATE_COLUMNS[field]);\n      else\n        // Just append\n        result.push(field);\n\n      return result;\n    }, []);\n  }\n\n  /** Removes the columns that are not applicable in the given view **/\n  static filterByView(columns, view) { \n    if (view === 'MY_DOCUMENTS')\n      // Remove columns specific to 'Shared With Me'\n      return columns.filter(c => !COLUMNS_SHARED_WITH_ME.includes(c));\n    else\n      // All\n      return columns; \n  }\n\n}","import React, { Component } from 'react';\nimport Draggable from 'react-draggable';\n\nexport default class Modal extends Component {\n\n  render() {\n    return (\n      <div className={`clicktrap ${this.props.className}`}>\n        <div className=\"modal-wrapper\">\n          <Draggable handle=\".modal-header\">\n            <div className=\"modal\">\n              <div className=\"modal-header\">\n                <h1 className=\"title\">{this.props.title}</h1>\n                <button\n                  className=\"close nostyle\"\n                  onClick={this.props.onClose}>&#xe897;</button>\n              </div>\n\n              <div className=\"modal-body\">\n                {this.props.children}\n              </div>\n            </div>\n          </Draggable>\n        </div>\n      </div>\n    )\n  }\n\n}\n","export default class Selection {\n    \n  constructor(selectedItems) {\n    if (selectedItems)\n      this._selection = selectedItems;\n    else \n      this._selection = [];\n  }\n\n  isEmpty() {\n    return this._selection.length === 0;\n  }\n\n  includes(item) {\n    return this._selection.includes(item);\n  }\n\n  isSingleSelection() {\n    return this._selection.length === 1;\n  }\n\n  isSingleFolder() {\n    return this._selection.length === 1 && this._selection[0].type === 'FOLDER';\n  }\n\n  isSingleDocument() {\n    return this._selection.length === 1 && this._selection[0].type === 'DOCUMENT';\n  }\n\n  includesText() {\n    const withText = this._selection.filter(item => {\n      return item.filetypes && item.filetypes.find(ft => ft.startsWith(\"TEXT\"));\n    });\n    return withText.length > 0;\n  }\n\n  get(idx) {\n    return this._selection[idx];\n  }\n\n  getItems() {\n    return this._selection;\n  }\n\n  getFolders() {\n    return this._selection.filter(i => i.type === 'FOLDER');\n  }\n\n  getDocuments() {\n    return this._selection.filter(i => i.type === 'DOCUMENT');\n  }\n\n  /** Immutable - returns a new selection object **/\n  selectItem = (item, isCtrlPressed) => {\n    if (isCtrlPressed) {\n      const thisIdx = this._selection.indexOf(item);\n      const isSelected = thisIdx > -1;\n    \n      let cloned = this._selection.slice(0);\n\n      // Toggle this item, leave the rest of the selection unchanged\n      if (isSelected) {\n        cloned.splice(thisIdx, 1);\n      } else {\n        cloned.push(item);\n      }      \n\n      return new Selection(cloned);\n    } else {\n      // Select just this item\n      return new Selection([ item ]);\n    }\n  }\n\n  /**\n   * Range selection: SHIFT + click. \n   * \n   * Behavior follows Mac conventions, cf. \n   * https://stackoverflow.com/questions/2959887/algorithm-for-shift-clicking-items-in-a-collection-to-select-them\n   * \n   * Immutable - returns a new selection object\n   */\n  selectRange = (allItems, toIdx) => {\n    const selectedIndices = this._selection.map(item => {\n      return allItems.indexOf(item);\n    });   \n    \n    const minIdx = Math.min.apply(null, selectedIndices);\n    const maxIdx = Math.max.apply(null, selectedIndices);\n\n    const isOutside = (toIdx > maxIdx) || (toIdx < minIdx);\n\n    const slice = (from, to) => allItems.slice(from, to + 1);\n\n    if (isOutside && toIdx > maxIdx)\n      // Expand selection downwards\n      return new Selection(slice(minIdx, toIdx));\n    else if (isOutside)\n      // Expand selection upwards\n      return new Selection(slice(toIdx, maxIdx));\n    else\n      // Fill from topmost\n      return new Selection(slice(minIdx, toIdx));\n  }\n\n  /** \n   * Helper function that handles click/SHIFT+click/CTRL+click selection \n   * on an item and returns a new selection, if valid.\n   */\n  handleClick(evt, item, idx, allItems) {\n    const isShift = evt.getModifierState(\"Shift\");\n    const isCtrl = evt.getModifierState(\"Control\");\n    \n    // Is this a selection or deselection?\n    const isSelectAction = \n      (isShift || isCtrl || ! this.includes(item));\n\n    if (isSelectAction) {\n      const newSelection = isShift ?\n        this.selectRange(allItems, idx) :\n        this.selectItem(item, isCtrl);\n\n      evt.preventDefault();\n      return newSelection;\n    }\n  }\n  \n}","import React, { Component } from 'react';\n\nexport default class Avatar extends Component {\n\n  // https://medium.com/@pppped/compute-an-arbitrary-color-for-user-avatar-starting-from-his-username-with-javascript-cd0675943b66\n  stringToHslColor(str) {\n    let hash = 0;\n    for (let i=0; i<str.length; i++) {\n      hash = str.charCodeAt(i) + ((hash << 5) - hash);\n    }\n    return hash % 360;\n  }\n\n  render() {\n    const color = this.props.username ? `hsl(${this.stringToHslColor(this.props.username)}, 35%, 65%)` : '#e2e2e2';\n\n    return (\n      <div className=\"avatar\" style={{ backgroundColor: color }}>\n        <div className=\"inner\">\n          { this.props.username && this.props.username.charAt(0).toUpperCase() }\n        </div>\n      </div>\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport posed from 'react-pose';\n\nconst AnimatedDiv = posed.div({\n  open:   { \n    bottom: '30px',\n    transition: {\n      ease: 'easeOut',\n      duration:200\n    }\n  },\n  closed: { bottom: '-140px' }\n});\n\nexport default class FiledropHint extends Component {\n\n  state = { \n    visible: false \n  };\n\n  componentDidMount() {\n    this.setState({ visible: true });\n  }\n\n  render() {\n    return (\n      <div className=\"filedrop-hint\">\n        <AnimatedDiv className=\"inner\" pose={this.state.visible ? 'open' : 'closed'}>\n          <span className=\"icon\">&#xf0ee;</span>\n          <p className=\"instructions\">\n            Drop files or IIIF manifest URLs to add them to your workspace.\n          </p>\n          <p className=\"supported\">\n            Supported formats: plain text (UTF-8), TEI/XML, image files, CSV (UTF-8)\n          </p>\n        </AnimatedDiv>\n      </div>\n    )\n  }\n\n}\n","/** Icons for possible content type values **/\nconst ICONS = {\n  TEXT_PLAIN   : 'icon_text.png',\n  TEXT_TEIXML  : 'icon_tei.png',\n  IMAGE_UPLOAD : 'icon_image.png',\n  IMAGE_IIIF   : 'icon_iiif.png',\n  DATA_CSV     : 'icon_csv.png',\n  MAP_WMTS     : 'icon_map.png',\n  MAP_XYZ      : 'icon_map.png' \n};\n\nexport default class TypeIcons {\n\n  static get = docType => ICONS[docType];\n\n}\n","import Selection from '../common/documents/Selection';\n\nconst DEFAULT_STATE = {\n  account: null,         // Null if not loaded\n  \n  view: 'MY_DOCUMENTS',  // MY_DOCUMENTS, SHARED_WITH_ME, SEARCH\n  presentation: 'TABLE', // 'TABLE' or 'GRID'\n\n  search_scope: null,    // If view is SEARCH\n  \n  page: {\n    breadcrumbs: null,\n    readme: null,\n    total_count: 0,\n    items: []             // Folders and documents\n  },\n\n  selection: new Selection(),        \n  \n  table_config: {\n    columns: [\n      \"author\",\n      \"title\",\n      \"language\",\n      \"date_freeform\",\n      \"uploaded_at\",\n      \"last_edit_at\"\n    ],\n    sorting: { by: null, asc: true } \n  },\n\n  busy: true             // If loading is in progress\n};\n\nexport const initialState = () => {\n\n  const stored = {};\n\n  // Helper\n  const addIfDefined = (key) => {\n    const value = localStorage.getItem(`recogito.workspace.${key}`);\n    if (value) stored[key] = JSON.parse(value);\n  }\n\n  ['view', 'presentation', 'table_config'].map(addIfDefined)\n\n  return { ...DEFAULT_STATE, ...stored };\n}\n\nexport const persistState = (key, value) => {\n  const prefixed = `recogito.workspace.${key}`\n  localStorage.setItem(prefixed, JSON.stringify(value));\n}\n\n","import React, { Component } from 'react';\n\nexport default class ModalForm extends Component {\n\n  componentDidMount() {\n    document.addEventListener('keydown', this.handleKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.handleKeydown, false);\n  }\n\n  handleKeydown = (evt) => {\n    if (evt.which === 27) this.props.onCancel(); // Escape\n  }\n\n  render() {\n    return (\n      <div className={`clicktrap ${this.props.className}`}>\n        <div className={`modal-wrapper modal-form-wrapper ${this.props.className}`}>\n          <div className=\"modal\">\n            <div className=\"modal-inner\">\n              <div>\n                {this.props.children}\n              </div>\n\n              <div className=\"footer\">\n                <button \n                  className=\"btn outline tiny\"\n                  onClick={this.props.onCancel}>Cancel</button>\n\n                <button\n                  className=\"btn tiny\"\n                  onClick={this.props.onOk}>Ok</button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport { render } from 'react-dom';\nimport axios from 'axios';\n\nimport ModalForm from '../ModalForm';\n\nclass CreateFolderForm extends Component {\n\n  state = {\n    folderName : ''\n  }\n\n  onChange = evt => {\n    this.setState({ folderName: evt.target.value });\n  }\n\n  onKeyPress = evt => {\n    if (evt.which === 13) // Enter\n      this.onOk();\n  }\n\n  onOk = () => {\n    this.props.onOk(this.state.folderName);\n  }\n\n  render() {\n    return (\n      <ModalForm\n        onOk={this.onOk}\n        onCancel={this.props.onCancel}>\n  \n        <input \n          type=\"text\" \n          autoFocus={true}\n          placeholder=\"Folder name\" \n          value={this.state.folderName}\n          onChange={this.onChange} \n          onKeyPress={this.onKeyPress}/>\n      </ModalForm>\n    )\n  }\n\n} \n\nexport const createFolder = () => {\n  return new Promise(resolve => {\n    const container = document.createElement('div');\n    document.body.appendChild(container);\n\n    const onOk = folderName => { \n      const currentFolderId = document.location.hash.substring(1);\n\n      axios.post('/api/folder', {\n        title: folderName || 'Unnamed Folder',\n        parent: currentFolderId\n      }).then(() => {\n        container.remove();\n        resolve();\n      });\n    }\n\n    const onCancel = () => {\n      container.remove();\n      resolve();\n    }\n\n    render(\n      <CreateFolderForm \n        onOk={onOk}\n        onCancel={onCancel} />, container);\n  });\n};\n\nexport const renameFolder = (folder, title) => {\n  return axios.put(`/api/folder/${folder.id}`, {\n    action: 'RENAME',\n    title: title\n  });\n}","import React, { Component } from 'react';\n\nexport default class Meter extends Component {\n\n  render() {\n    return (\n      <div\n        className=\"meter\"\n        style={{ position: 'relative' }}>\n\n        <div\n          className=\"bar\"\n          style={{\n            width: `${100 * this.props.value}%`,\n            height: '100%'\n          }} />\n      </div>\n    )\n  }\n\n}\n","import React from 'react';\nimport Meter from '../../../common/Meter.jsx';\n\nconst FileProgress = props => {\n\n  return (\n    <li>\n      {props.upload.file.name}\n      <span className={`icon spinner ${props.upload.status}`}></span>\n    </li>\n  );\n\n}\n\nconst ImportProgressModal = props => {\n  const totalLoaded = props.uploads.reduce((total, u) => total + u.progress, 0);\n    \n  const errors = props.uploads.reduce((errors, u) => { \n    if (u.error) errors.push(u.error);\n    return errors;\n  }, []);\n\n  return (\n    <div className=\"upload-progress\">\n      <div className=\"phase\">\n        { props.phase }\n\n        <button \n          className=\"close nostyle\"\n          onClick={props.onClose}>&#xe897;</button>\n      </div>\n\n      <ul className={`files${(errors.length > 0) ? ' has-errors' : ''}`}>\n        { props.uploads.map(u => <FileProgress key={u.file.name} upload={u} />) }\n\n        { props.uploads.length === 0 &&\n          <li>\n            Fetching content from remote source...\n            <span className=\"icon spinner RUNNING\"></span>\n          </li>\n        }\n      </ul>\n\n      { errors.length > 0 && \n        <ul className=\"errors\">\n          <li>{errors.join()}</li>\n        </ul> \n      }\n\n      <div className=\"progress\">\n        <Meter value={totalLoaded / props.totalSize} />\n      </div>\n    </div>\n  )\n\n}\n\nexport default ImportProgressModal;","import React, { Component } from 'react';\nimport axios from 'axios';\nimport ImportProgressModal from './ImportProgressModal';\n\n/** \n * A stateful container component to manage the\n * upload process.\n */\nexport default class Uploader extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = this.initialState(props);\n    this.start();\n  }\n\n  initialState(props) {\n    return {\n      phase: 'Uploading',\n      totalSize: props.files.reduce((total, f) => f.size + total, 0),\n      uploadId: null,\n      uploads: props.files.map(f => {\n        return {\n          file: f,\n          filepartId: null,\n          status: 'UPLOADING', \n          progress: 0,\n          error: null\n        };\n      }),\n      error: null\n    };\n  }\n\n  componentWillReceiveProps(props) {\n    this.setState(this.initialState(props));\n  }\n\n  /** Helper to update a specific upload in the state array **/\n  updateUploadState = (upload, diff) => {\n    this.setState(prev => { \n      return { \n        uploads: prev.uploads.map(u => u.file === upload.file ? { ...u, ...diff } : u) \n      }\n    });\n  }\n\n  /**\n   * Initializes a new document, using the filename as title,\n   * or a 'New document' placeholder in case there are multiple files.\n   */\n  initNewDocument = () => {\n    const title = (this.state.uploads.length === 1) ? this.state.uploads[0].file.name : 'New document';\n    const formdata = new FormData();\n    formdata.append('title', title);\n\n    return axios.post('/my/upload', formdata, {\n      headers: { 'X-Requested-With': 'XMLHttpRequest' }\n    });\n  }\n\n  /** Uploads files in parallel **/\n  uploadFiles = () => {\n    // Helper: handles upload for one file\n    const uploadOne = upload => {\n      const formdata = new FormData();\n      formdata.append('file', upload.file);\n\n      const onUploadProgress = (evt) => {\n        this.updateUploadState(upload, { progress: evt.loaded });\n      }\n\n      return axios.post(`/my/upload/${this.state.uploadId}/file`, formdata, {\n        headers: { 'X-Requested-With': 'XMLHttpRequest' },\n        onUploadProgress: onUploadProgress\n      }).then(result => {\n        this.updateUploadState(upload, { \n          filepartId: result.data.uuid\n        });\n        return result;\n      }).catch(error => {\n        this.updateUploadState(upload, {\n          status: 'FAILED',\n          error: error.response.data\n        });\n        throw error;\n      });\n    }\n\n    // The list of request promises...\n    const requests = this.state.uploads.map(uploadOne);\n\n    // ... rolled into a promise of the list of request results\n    return Promise.all(requests);\n  }\n\n  importRemoteSource() {\n    this.setState({ phase: 'Importing' });\n\n    const formdata = new FormData();\n    formdata.append('url', this.props.remoteSource.url);\n    formdata.append('type', this.props.remoteSource.sourceType);\n\n    return axios.post(`/my/upload/${this.state.uploadId}/file`, formdata, {\n      headers: { 'X-Requested-With': 'XMLHttpRequest' }\n    });\n  }\n\n  finalizeDocument = withError => {\n    const currentFolder = document.location.hash.substring(1);\n\n    const url = currentFolder ?\n      `/my/upload/${this.state.uploadId}/finalize?folder=${currentFolder}` :\n      `/my/upload/${this.state.uploadId}/finalize`;\n\n    return axios.post(url, {\n      headers: { 'X-Requested-With': 'XMLHttpRequest' }\n    }).then(result => {\n      const tasks = result.data.running_tasks;\n\n      if (tasks && tasks.length > 0) {\n        this.setState({ phase: 'Importing...' });\n        this.pollTaskProgress(result.data.document_id, tasks);\n      } else {\n        this.setState({ phase: 'Completed' });\n        this.state.uploads.forEach(u => {\n          if (u.status !== 'FAILED') this.updateUploadState(u, { status: 'COMPLETED' });\n        });\n        if (!withError)\n          this.props.onComplete();\n      }\n    });\n  }\n\n  pollTaskProgress = (documentId, taskTypes) => {    \n    axios.get(`/api/job?id=${documentId}`)\n      .then(result => {\n        this.state.uploads.forEach(u => {\n          const progress = result.data.subtasks.find(t => t.filepart_id === u.filepartId);\n          if (progress)\n            this.updateUploadState(u, { status: progress.status });\n          else // No progress status - complete\n            this.updateUploadState(u, { status: 'COMPLETED' });\n        });\n\n        const isComplete = this.state.uploads.reduce((isComplete, u) => {\n          return isComplete && u.status === 'COMPLETED';\n        }, true);\n\n        if (isComplete) {\n          this.setState({ phase: 'Completed' });\n          this.props.onComplete();\n        } else {\n          setTimeout(() => this.pollTaskProgress(documentId, taskTypes), 1000);\n        }\n      }).catch(error => {\n        if (error.response.status === 404)\n          // Tasks might still be initializing\n          setTimeout(() => this.pollTaskProgress(documentId, taskTypes), 1000);\n      });\n  }\n\n  /** \n   * Starts a new upload.\n   * \n   * Since one document generally consists of multiple files, the \n   * upload process is three-stage: \n   * \n   * 1. the new document is initialized, and assigned an ID on the server\n   * 2. all files are uploaded to this document\n   * 3. a finalization requests closes the document, and waits for any\n   *   processing (image tiling, TEI conversion) to finish\n   */\n  start() {\n    this.initNewDocument().then((result) => {\n      this.setState({ uploadId: result.data.id });\n      // Branch based on files vs. remote URL\n      return this.props.remoteSource ?\n        this.importRemoteSource() : this.uploadFiles();\n    })\n    .then(() => this.finalizeDocument(false))\n    .catch(error => {\n      this.setState({ error: error });\n      this.finalizeDocument(true);\n      throw error;\n    });\n  }\n\n  render() {\n    return (\n      <ImportProgressModal\n        phase={this.state.phase}\n        totalSize={this.state.totalSize}\n        uploads={this.state.uploads}\n        error={this.state.error}\n        onClose={this.props.onClose} />\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport ShineBrowser from \"react-shine-api\";\n\nclass SHINEModal extends Component {\n\n  SHINEFileUpload = files => {\n    let convertedFiles = [];\n\n    // convert strings to file\n    files.forEach(file => {\n      var newFile = new File([file.content], `${file.name || 'rise_file'}.txt`, {\n        type: \"text/plain\",\n      });\n      convertedFiles.push(newFile);\n    });\n\n    this.props.onUploadFiles(convertedFiles);\n  }\n\n  handleSHINEModalClick = (e) => {\n    if(e.target.id !== 'shinemodal') return;\n    this.props.onClose();\n  }\n\n  render() {\n    return(\n      <div \n        style={styles.shineModal} \n        id=\"shinemodal\" \n        onClick={this.handleSHINEModalClick}>\n\n        <div style={styles.shineBrowserContainer}>\n          <ShineBrowser\n            styles={{\n              primary: \"#4483C4\",\n              borderRadius: 2,\n              fontFamily: 'Assistant',\n              text: '#3f3f3f'\n            }}\n            close={this.props.onClose}\n            handleFileUpload={this.SHINEFileUpload}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n\nconst styles = {\n  shineModal: {\n    position: 'fixed',\n    backgroundColor: 'rgba(0,0,0,.5)',\n    zIndex: 100,\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center'\n  },\n  shineBrowserContainer: {\n    maxHeight: 800,\n    maxWidth: 1200,\n    margin: 20,\n    width: '100%',\n    height: '100%',\n    boxShadow: '0 .5rem 1rem rgba(0,0,0,.35)'\n  }\n}\n\nexport default SHINEModal;","import React, { Component } from 'react';\nimport { render } from 'react-dom';\nimport Importer from './Importer';\nimport ModalForm from '../ModalForm';\nimport { importFromShine } from './shine';\n\n/**\n * Basically a simple popup box with a text input field,\n * but with the added functionality that it's possible to\n * drag-and-drop a URL into the input field.\n */\nclass URLInputForm extends Component {\n\n  state = {\n    url : ''\n  }\n\n  onChange = evt => {\n    this.setState({ url: evt.target.value });\n  }\n\n  onDrop = evt => {\n    const url = evt.dataTransfer.getData('text');\n    this.setState({ url: url });\n  }\n\n  onKeyPress = evt => {\n    if (evt.which === 13) // Enter\n      this.onOk();\n  }\n\n  onOk = () => {\n    this.props.onOk(this.state.url);\n  }\n\n  render() {\n    return (\n      <ModalForm\n        onOk={this.onOk}\n        onCancel={this.props.onCancel}>\n  \n        <input \n          type=\"text\" \n          autoFocus={true}\n          placeholder=\"Paste or drag URL\" \n          value={this.state.url}\n          onChange={this.onChange} \n          onDrop={this.onDrop}\n          onKeyPress={this.onKeyPress}/>\n      </ModalForm>\n    )\n  }\n\n} \n\nconst promptForUrl = () => {\n\n  return new Promise(resolve => {\n    const container = document.createElement('div');\n    document.body.appendChild(container);\n\n    const done = url => { \n      container.remove();\n      resolve(url);\n    }\n\n    render(\n      <URLInputForm \n        onOk={done}\n        onCancel={() => done()} />, container);\n  });\n\n}\n\nconst identifySource = url => {\n  if (url.includes('request=GetPassage'))\n    return 'CTS';\n  else if (url.endsWith('.xml'))\n    return 'TEI_XML';\n  else if (url.includes('textgridlab.org'))\n    return 'TEI_XML'; // Textgrid doesn't end links with .xml...\n  else // to be extended later\n    return 'IIIF';\n}\n\nconst importContent = (files, remoteSource) => {\n  return new Promise(resolve => {\n    const container = document.createElement('div');\n    document.body.appendChild(container);\n\n    const onComplete = () => {\n      container.remove();\n      resolve();\n    }\n\n    const onClose = result => {\n      container.remove();\n    }\n\n    render(<Importer \n      files={files}\n      remoteSource={remoteSource}\n      onComplete={onComplete}\n      onClose={onClose} />, container);\n  });\n}\n\n/** Import a list of files **/\nexport const uploadFiles = files => {\n  return importContent(files);\n}\n\n/** \n * Import content from a remote source\n * \n * Note that one argument (either type or URL) may be undefined. \n * \n * -) When a URL is imported via drag-and-drop, only the URL will be\n * provided (and we can use the 'identifySource' function to attempt\n * type identification)\n * \n * -) When a source is imported via the sidebar menu option, only\n * the type will be provided & this class will provide (or delegate) the\n * import UI components.\n */\nexport const importSource = (typ, url) => {\n  const sourceType = typ || identifySource(url);\n  if (typ === 'SHINE') {\n    return importFromShine().then(files => { \n      if (files)\n        return uploadFiles(files);\n    });\n  } else if (url) {\n    return importContent([], { url: url, sourceType: sourceType });\n  } else {\n    return promptForUrl().then(url => {\n      if (url)\n        return importContent([], { url: url, sourceType: sourceType });\n    });\n  }\n}","import React, { Component } from 'react';\nimport axios from 'axios';\nimport Meter from '../../../../common/Meter.jsx';\n\nexport default class NERProgressModal extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      status: 'PENDING',\n      progress: 0, // 0 - 100\n      tasks: 0,\n      tasksCompleted: 0\n    };\n\n    this.pollProgress();\n  }\n\n  pollProgress() { \n    axios.get(`/api/job/${this.props.jobId}`)\n      .then(result => {\n        this.setState({\n          status: result.data.status,\n          progress: result.data.progress,\n          tasks: result.data.subtasks.length,\n          tasksCompleted: result.data.subtasks.filter(t => t.status === 'COMPLETED').length,\n          tasksFailed: result.data.subtasks.filter(t => t.status === 'FAILED').length\n        });\n\n        const isDone = result.data.status === 'COMPLETED' || result.data.status === 'FAILED';\n        if (isDone)\n          this.props.onComplete && this.props.onComplete();\n        else\n          setTimeout(() => this.pollProgress(), 1000);\n      })\n      .catch(error => {\n        if (error.response.status === 404)\n          // Tasks might still be initializing\n          setTimeout(() => this.pollProgress(), 1000);\n      });\n  }\n\n  render() {\n    const isDone = \n      this.state.status === 'COMPLETED' || \n      this.state.status === 'FAILED';\n\n    return (\n      <div className=\"job-progress\">\n        <div className=\"header\">\n          Named Entity Recognition { isDone && <button \n            className=\"close nostyle\"\n            onClick={this.props.onClose}>&#xe897;</button>\n          }\n        </div>\n\n        <div className=\"body\">\n          <div className=\"message\">\n            Parsed {this.state.tasksCompleted} of {this.state.tasks} files\n            <span className={`icon spinner ${this.state.status}`}></span>\n          </div>\n\n          <div className=\"progress\">\n            <Meter value={this.state.progress / 100} />\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n}","import React, { Component } from 'react';\n\nexport default class AuthoritySelection extends Component {\n\n  onChange(identifier) {   \n    const selection = this.props.selected; \n    const currentIdx = selection.indexOf(identifier);\n\n    if (currentIdx < 0)\n      selection.push(identifier);\n    else\n      selection.splice(currentIdx, 1); \n\n    this.props.onChange(selection);\n  }\n\n  render() {    \n    return (\n      <div className=\"authorities\">\n        <h2>Authority Files</h2>\n\n        <input\n          type=\"checkbox\" \n          id=\"use-all-authorities\"\n          checked={this.props.useAll} \n          onChange={this.props.onToggleAll} />\n        <label htmlFor=\"use-all-authorities\">identify entities against all available authority files</label>\n\n        <div className={`authority-list${this.props.useAll ? ' disabled' : ''}`}>\n          <table>\n            <tbody>\n              {this.props.authorities.map(authority => \n                <tr key={authority.identifier}>\n                  <td>\n                    <input \n                      type=\"checkbox\" \n                      id={authority.identifier} \n                      checked={this.props.selected.includes(authority.identifier)} \n                      onChange={this.onChange.bind(this, authority.identifier)} />\n                    <label htmlFor={authority.identifier} />\n                  </td>\n\n                  <td className=\"shortname\">\n                    <span style={{ backgroundColor: authority.color}}>\n                      {authority.homepage ? \n                        <a href={authority.homepage} \n                          target=\"_blank\"\n                          rel=\"noopener noreferrer\">{authority.shortname}</a>\n                        : \n                        authority.shortname\n                      }\n                    </span>\n                  </td>\n\n                  <td className=\"fullname\">\n                    {authority.fullname}\n                  </td>\n                </tr>\n              )}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nexport default class EngineSelection extends Component {\n\n  render() {\n    return (\n      <div className=\"engines\">\n        <h2>Recognition Engines</h2>\n        <table cellSpacing=\"0\">\n          <tbody>\n            {this.props.engines.map((engine, idx) =>\n              <React.Fragment key={idx}>\n                <tr>\n                  <td className=\"name\">\n                    <input \n                      id={engine.identifier}\n                      type=\"radio\" \n                      group=\"engines\" \n                      checked={this.props.selected === engine.identifier}\n                      onChange={this.props.onChange.bind(this, engine.identifier)} />\n                    \n                    <label htmlFor={engine.identifier}>\n                      <span className=\"name\">{engine.name}</span>\n                    </label>\n                  </td>\n\n                  <td className=\"languages\">\n                    { engine.languages.map(lang => <span key={lang}>{lang}</span>) }\n                  </td>\n\n                  <td className=\"description\">\n                    {engine.description}\n                  </td>\n                </tr>\n                \n                <tr className=\"spacer\"></tr>\n              </React.Fragment>\n            )}\n          </tbody>\n        </table>\n        <p className=\"note\">\n          Note: different engines can provide different results and are generally \n          optimized for a specific language.\n        </p>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport axios from 'axios';\nimport Modal from '../../../../common/Modal';\nimport AuthoritySelection from './authorities/AuthoritySelection';\nimport EngineSelection from './engines/EngineSelection';\n\nexport default class NERModal extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      available_engines: [],\n      available_authorities: [],\n\n      selected_engine: null,\n      selected_all_authorities: true,\n      selected_authorities: []\n    };\n\n    this.initAvailableAuthorities();\n    this.initAvailableEngines();\n  }\n\n  isInitComplete() {\n    return this.state.available_engines.length > 0 &&\n      this.state.available_authorities.length > 0;\n  }\n\n  initAvailableEngines() {\n    if (this.state.available_engines.length === 0)\n      axios.get('/api/plugins/ner')\n        .then(result => {\n          const diff = { available_engines: result.data };\n\n          if (!this.state.selected_engine) // Select first as default\n            diff.selected_engine = result.data[0] && result.data[0].identifier;\n\n          this.setState(diff);\n        });\n  }\n\n  initAvailableAuthorities() {\n    axios.get('/api/authorities/gazetteers')\n      .then(result => {\n        const diff = { available_authorities: result.data };\n\n        if (this.state.selected_all_authorities || \n             (!this.state.selected_all_authorities && this.state.selected_authorities.length === 0))\n          diff.selected_authorities = result.data.map(a => a.identifier);\n\n        this.setState(diff);\n      });\n  }\n\n  changeEngine(identifier) {\n    this.setState({ selected_engine: identifier });\n  }\n\n  toggleAllAuthorities() {\n    this.setState(prev => {\n      return { selected_all_authorities: !prev.selected_all_authorities }\n    });\n  }\n\n  changeAuthorities(authorities) {\n    this.setState({ selected_authorities: authorities });\n  }\n\n  onStart() {\n    const response = { engine: this.state.selected_engine };\n\n    if (this.state.selected_all_authorities)\n      response.all_authorities = true;\n    else \n      response.authorities = this.state.selected_authorities;\n\n    this.props.onStart(response);\n  }\n\n  render() {\n    return (\n      <Modal\n        className=\"ner\" \n        title=\"Named Entity Recognition (NER)\"\n        onClose={this.props.onCancel}>\n\n        <p>\n          NER identifies places and persons in your text automatically. \n          Depending on the length of your text, this may take a while. \n        </p>\n\n        <EngineSelection \n          engines={this.state.available_engines} \n          selected={this.state.selected_engine}\n          onChange={this.changeEngine.bind(this)} />\n\n        <AuthoritySelection \n          authorities={this.state.available_authorities} \n          useAll={this.state.selected_all_authorities}\n          selected={this.state.selected_authorities}\n          onToggleAll={this.toggleAllAuthorities.bind(this)} \n          onChange={this.changeAuthorities.bind(this)} />\n\n        <div className=\"buttons\">\n          <button\n            className=\"btn start\"\n            onClick={this.onStart.bind(this)}>Start NER</button>\n\n          <button \n            className=\"btn outline cancel\"\n            onClick={this.props.onCancel}>Cancel</button>\n        </div>\n      </Modal>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport axios from 'axios';\nimport NERProgressModal from './progress/NERProgressModal';\nimport NERConfigurationModal from './configuration/NERConfigurationModal';\n\n/** \n * A stateful container component to manage the\n * entity recognition process.\n */\nexport default class EntityRecognition extends Component {\n\n  state = {\n    running: false,\n    jobId: null\n  }\n\n  start = config => {\n    const textDocuments = this.props.selection.getItems().filter(item => {\n      const isDocument = item.type === 'DOCUMENT';\n      const hasTextParts = item.filetypes.filter(t => t.startsWith('TEXT')).length > 0;\n      return isDocument && hasTextParts;\n    });\n\n    const taskDefinition = { \n      ...{ task_type: 'NER', documents: textDocuments.map(d => d.id) }, \n      ...config \n    }\n\n    axios.post('/api/job', taskDefinition).then(response => {\n      this.setState({\n        running: true,\n        jobId: response.data.job_id\n      });\n    });\n  }\n\n  render() {\n    return this.state.running ? (\n      <NERProgressModal\n        jobId={this.state.jobId} \n        onComplete={this.props.onComplete} \n        onClose={this.props.onClose} />\n    ) : (\n      <NERConfigurationModal \n        onStart={this.start} \n        onCancel={this.props.onCancel} />\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport axios from 'axios';\n\nexport default class MapKurator extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      complete: false,\n      jobId: null,\n      error: null\n    }\n\n    this.start();\n  }\n\n  pollProgress() { \n    axios.get(`/api/job/${this.state.jobId}`)\n      .then(result => {\n        const isDone = result.data.status === 'COMPLETED' || result.data.status === 'FAILED';\n        if (isDone) {\n          if (result.data.status === 'FAILED') {\n            const { message } = result.data.subtasks[0];\n            this.setState({ complete: true, error: message });\n            this.props.onComplete();\n          } else {\n            this.setState({ complete: true });\n            this.props.onComplete();\n          }\n        } else {\n          setTimeout(() => this.pollProgress(), 1000);\n        }\n      })\n      .catch(error => {\n        if (error.response.status === 404)\n          // Tasks might still be initializing\n          setTimeout(() => this.pollProgress(), 1000);\n      });\n  }\n\n  start = () => {\n    // This is unsafely hard-wired to assume a single image filepart\n    const document = this.props.selection.getItems()[0];\n\n    const taskDefinition = {\n      task_type: 'MAPKURATOR', \n      documents: [ document.id ]\n    }\n\n    axios.post('/api/job', taskDefinition).then(response => {\n      this.setState({\n        jobId: response.data.job_id\n      });\n\n      this.pollProgress();\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"job-progress\">\n        <div className=\"header\">\n          mapKurator { this.state.complete && <button \n            className=\"close nostyle\"\n            onClick={this.props.onClose}>&#xe897;</button>\n          }\n        </div>\n\n        <div className=\"body\">\n          <div className=\"message\">\n            {(this.state.complete && !this.state.error) && \n              <span>Processing successful!</span>\n            }\n\n            {this.state.error && \n              <span>Processing failed: {this.state.error}</span>\n            }\n\n            {!this.state.complete &&\n              <span>This may take a while...</span>\n            }\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n}","import axios from 'axios';\n\n/** API URL for POST or DELETE **/\nconst getUrl = () => {\n  const currentFolderId = document.location.hash.substring(1);\n  return currentFolderId ?\n    `/api/folder/${currentFolderId}/readme` : '/api/directory/my/readme';\n}\n\n\nexport const updateReadme = function(readme, currentPageState) {\n  return axios.post(getUrl(), { data: readme }).then(() => { \n    return { ...currentPageState, ...{ readme: readme } };\n  });\n}\n\nexport const deleteReadme = function(currentPageState) {\n  return axios.delete(getUrl()).then(() => {\n    return { ...currentPageState, ...{ readme: null } };\n  }); \n}","import React, { Component } from 'react';\nimport axios from 'axios';\nimport Draggable from 'react-draggable';\nimport ReactCSSTransitionReplace from 'react-css-transition-replace';\nimport Icons from '../../../common/documents/table/rows/TypeIcons';\n\nconst TITLES = {\n  MY_DOCUMENTS: 'My Documents',\n  SHARED_WITH_ME: 'Shared with me'\n}\n\nconst FolderItem = props => (\n  <li\n    className={props.selected ? 'folder selected' : 'folder'}\n    onClick={() => props.onSelect(props.item.id)}>{props.item.title}\n    { props.item.has_subfolders && \n      <button \n        className=\"nostyle icon\" \n        onClick={evt => props.onNavigateInto(props.item.id, evt)}>&#xe684;</button> }\n  </li>\n)\n\n\nconst DisabledDocumentItem = props =>  {\n\n  const docType = props.item.filetypes[0];\n\n  return (\n    <li className=\"document\">\n      <img src={`/assets/images/${Icons.get(docType)}`} alt={`icon type ${docType}`} />\n      {props.item.title}\n    </li>\n  )\n}\n\nexport default class FolderBrowser extends Component {\n  \n  constructor(props) {\n    super(props);\n    this.state = this.pageToState(props.page);\n  }\n  \n  /** \n   * Reads a page object and converst the info to the state's\n   * expected { location, subfolders } format.\n   */\n  pageToState = page => {\n    const b = page.breadcrumbs;\n    \n    // Build location from breadcrumbs\n    const location = b.length > 1 ? \n      { ...b[b.length - 1], parent: b[b.length - 2].id } : // has parent folder\n      b.length > 0 ? b[b.length - 1] : 'ROOT';\n\n    return { \n      location, // 'VIEWS', 'ROOT' or folder object\n      items: page.items,\n      selected: null,\n      transition: null\n    };\n  }\n\n  select = id => this.setState({ selected: id });\n\n  goToFolder = id => {\n    const url = \n      this.props.view === 'MY_DOCUMENTS' ? \n        ( id ? `/api/directory/my/${id}` : '/api/directory/my' ) :\n        ( id ? `/api/directory/my/shared/${id}` : '/api/directory/my/shared');\n\n    axios.get(url).then(result => {\n      this.setState(this.pageToState(result.data));\n    });\n  }\n\n  goToViewsOverview = () => {\n    this.setState({\n      location: 'VIEWS',\n      items: [\n        { title: 'My Documents', has_subfolders: true }\n      ],\n      selected: null,\n      transition: null\n    });\n  }\n\n  navigateUp = () => {\n    const goUp = () => {\n      const { location } = this.state;\n      if (location === 'ROOT') // root level of current view\n        this.goToViewsOverview();        \n      else\n        this.goToFolder(location.parent);      \n    }\n\n    this.setState({ transition: 'UP'}, goUp);\n  }\n\n  navigateInto = (folderId, evt) => {\n    evt.stopPropagation(); // Avoid select\n    const goInto = () => this.goToFolder(folderId);\n    this.setState({ transition: 'INTO'}, goInto);\n  }\n\n  move = () => {\n    const { selection } = this.props;\n    const destination = this.state.selected;\n\n    const documents = selection.getDocuments();\n    const folders = selection.getFolders();\n\n    const fDocs = documents.length > 0 ?\n      axios.put('/api/document/bulk', {\n        action: 'MOVE_TO', \n        destination,\n        documents: this.props.selection.getDocuments().map(d => d.id)\n      }) : Promise.resolve();\n\n    const fFolders = folders.length > 0 ? \n      axios.put('/api/folder/bulk', {\n        action: 'MOVE_TO', \n        destination,\n        folders: this.props.selection.getFolders().map(d => d.id)\n      }) : Promise.resolve();\n\n    Promise.all([ fDocs, fFolders ]).then(() => this.props.onComplete());\n  }\n\n  render() {\n    const title = \n      this.state.location === 'VIEWS' ? 'Workspace' :\n        this.state.location === 'ROOT' ? TITLES[this.props.view] : this.state.location.title;\n\n    const key = \n      this.state.location.id ? this.state.location.id : this.state.location;\n\n    const items = this.state.items.map(f => f.type === 'DOCUMENT' ?\n      <DisabledDocumentItem\n        key={f.id ? f.id : f.title}\n        item={f} /> :\n\n      <FolderItem \n        key={f.id ? f.id : f.title}\n        item={f}\n        selected={this.state.selected === f.id}\n        onSelect={this.select}\n        onNavigateInto={this.navigateInto} />\n    );\n\n    return (\n      <div className=\"clicktrap\">\n        <div className=\"modal-wrapper\">\n          <Draggable handle=\".header\">\n            <div className=\"modal folder-browser\">\n              <div className=\"header\">\n                { this.state.location !== 'VIEWS' && \n                  <button\n                    className=\"nostyle icon up\"\n                    onClick={this.navigateUp}>&#xe686;</button>\n                }\n\n                <span className=\"title\">{title}</span>\n\n                <button\n                  className=\"nostyle icon cancel\"\n                  onClick={this.props.onCancel}>&#xe680;</button>\n              </div>\n\n              <div className=\"body\">\n                <ReactCSSTransitionReplace\n                  transitionName=\"wipe\"\n                  transitionEnterTimeout={200}\n                  transitionLeaveTimeout={200}>\n\n                  <ul className={this.state.transition === 'UP' ? 'up' : 'into'}\n                      key={key}>{items}</ul>\n\n                </ReactCSSTransitionReplace>\n              </div>\n\n              <div className=\"footer\">\n                <button \n                  className=\"btn\"\n                  disabled={this.state.selected === null}\n                  onClick={this.move}>Move here</button>\n              </div>\n            </div>\n          </Draggable>\n        </div>\n      </div>\n    )\n  }\n\n}\n\n","import React, { Component } from 'react';\nimport { render } from 'react-dom';\nimport Draggable from 'react-draggable';\n\nclass Prompt extends Component {\n\n  componentDidMount() {\n    document.addEventListener('keydown', this.onKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.onKeydown, false);\n  }\n\n  onKeydown = (evt) => {\n    if (evt.which === 27) this.props.onNo();\n  }\n\n  render() {\n    const className = (this.props.type) ? `prompt ${this.props.type.toLowerCase()}` : 'prompt';\n\n    return (\n      <div className=\"clicktrap\">\n        <Draggable handle=\".prompt-header\">\n          <div className={className}>\n            <div className=\"prompt-header\">\n              <h1 className=\"title\">{this.props.title}</h1>\n            </div>\n\n            <div className=\"prompt-body\">\n              <p className=\"message\">{this.props.message}</p>\n              <p className=\"buttons\">\n                 <button className=\"btn yes\" onClick={this.props.onYes}>YES</button>\n                 <button className=\"btn outline no\" onClick={this.props.onNo}>NO</button>\n              </p>\n            </div>\n          </div>\n        </Draggable>\n      </div>\n    )\n  }\n\n}\n\nexport const prompt = props => {\n  const promptRoot = document.createElement('div');\n  promptRoot.setAttribute('id', 'confirm-prompt-root');\n  document.body.append(promptRoot);\n\n  const onYes = () => {\n    promptRoot.remove();\n    props.onConfirm();\n  }\n\n  const onNo = () => {\n    promptRoot.remove();\n    props.onCancel && props.onCancel();\n  }\n\n  render(\n    <Prompt \n      title={props.title}\n      type={props.type}\n      message={props.message}\n      onYes={onYes}\n      onNo={onNo} />, promptRoot);\n}","import React, { Component } from 'react';\nimport { render } from 'react-dom';\nimport Draggable from 'react-draggable';\n\nclass Alert extends Component {\n\n  componentDidMount() {\n    document.addEventListener('keydown', this.onKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.onKeydown, false);\n  }\n\n  onKeydown = (evt) => {\n    if (evt.which === 27) this.props.onClose();\n  }\n\n  render() {\n    const className = (this.props.type) ? `prompt ${this.props.type.toLowerCase()}` : 'prompt';\n\n    return (\n      <div className=\"clicktrap\">\n        <Draggable handle=\".prompt-header\">\n          <div className={className}>\n            <div className=\"prompt-header\">\n              <h1 className=\"title\">{this.props.title}</h1>\n            </div>\n\n            <div className=\"prompt-body\">\n              <p className=\"message\">{this.props.message}</p>\n              <p className=\"buttons\">\n                <button className=\"btn\" onClick={this.props.onClose}>Close</button>\n              </p>\n            </div>\n          </div>\n        </Draggable>\n      </div>\n    )\n  }\n\n}\n\nexport const alert = props => {\n  const promptRoot = document.createElement('div');\n  promptRoot.setAttribute('id', 'alert-root');\n  document.body.append(promptRoot);\n\n  const onClose = () => {\n    promptRoot.remove();\n    props.onClose && props.onClose();\n  }\n\n  render(\n    <Alert \n      title={props.title}\n      type={props.type}\n      message={props.message}\n      onClose={onClose} />, promptRoot);\n}","import React, { Component } from 'react';\nimport axios from 'axios';\n\nexport default class PublicAccess extends Component {\n\n  state = {\n    visibility: 'PRIVATE',\n    access_level: 'READ_ALL'\n  }\n\n  componentDidMount() {\n    axios.get(`/api/sharing/folders/${this.props.item.id}/visibility`)\n      .then(result => {\n        const { visibility, access_level } = result.data;\n        this.setState({ visibility: visibility, access_level: access_level || 'READ_ALL' });\n      });\n  }\n\n  updateSetting = (update) => {\n    this.setState(update, () => {\n      axios.post('/api/sharing/folders/visibility', {\n        ...this.state, ids: [ this.props.item.id ]\n      }).catch(error => {\n        // TODO \n      });\n    });\n  }\n\n  onChangeVisibility = (visibility) => {\n    this.updateSetting({ visibility: visibility });\n  }\n\n  onChangeAccessLevel = (evt) => {\n    this.updateSetting({ access_level: evt.target.value });\n  }\n\n  render() {\n    return (\n      <div className=\"public-access\">\n        <div className=\"multi-share-section\">\n          <h3>Enable Public Access</h3>\n          <div>\n            <input \n              type=\"radio\" \n              name=\"public-access\" id=\"pa-off\"\n              checked={this.state.visibility === 'PRIVATE'} \n              onChange={() => this.onChangeVisibility('PRIVATE')} />\n            <label htmlFor=\"pa-off\">Off</label>\n            <p>\n              Only people you explicitly add as collaborators have access.\n            </p>\n          </div>\n\n          <div>\n            <input \n              type=\"radio\" \n              name=\"public-access\" \n              id=\"pa-public\" \n              checked={this.state.visibility === 'PUBLIC'} \n              onChange={() => this.onChangeVisibility('PUBLIC')} />\n            <label htmlFor=\"pa-public\">Anyone on the Web</label>\n            <p>\n              Public documents are listed on your profile page, and anyone on the Internet can find them.\n            </p>\n          </div>\n\n          <div>\n            <input \n              type=\"radio\"\n              name=\"public-access\" \n              id=\"pa-with-link\" \n              checked={this.state.visibility === 'WITH_LINK'} \n              onChange={() => this.onChangeVisibility('WITH_LINK')} />\n            <label htmlFor=\"pa-with-link\">Anyone with the Link</label>\n            <p>\n              Accessible to anyone who has the link, but it is not listed on your profile page.\n            </p>\n          </div>\n        </div>\n\n        <div className=\"multi-share-section\">\n          <strong>Access:</strong> anyone can\n\n          <select value={this.state.access_level} onChange={this.onChangeAccessLevel}>\n            <option value=\"READ_ALL\">view</option>\n            <option value=\"READ_DATA\">view map and downloads but not document content</option>\n            <option value=\"WRITE\">annotate</option>\n          </select>\n\n          <p>\n            Annotating requires a Recogito account. Visitors who are not logged in can view\n            documents (if enabled), and download annotations from the download page. But \n            they cannot add annotations, even when public annotation is enabled. Blocking \n            access to document content will also limit some of the download options.\n          </p>\n\n          <div className=\"footer\">\n            <button className=\"btn\" onClick={this.props.onClose}>Close</button>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport { render} from 'react-dom';\n\nclass PermissionSelector extends Component {\n\n  componentDidMount() {\n    document.addEventListener('mousedown', this.onMousedown, false);\n    document.addEventListener('keydown', this.onKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('mousedown', this.onMousedown, false);\n    document.removeEventListener('keydown', this.onKeydown, false);\n  }\n\n  onMousedown = (evt) => {\n    const isClickOutside = !this._node.contains(evt.target);\n    if (isClickOutside) this.props.onCancel();\n  }\n\n  onKeydown = (evt) => {\n    evt.stopPropagation();\n    if (evt.which === 27) this.props.onCancel();\n  }\n\n  handleCancel= () => {\n    this.props.onCancel();\n  }\n\n  changeLevel(level) {\n    this.props.onChangeLevel(level);\n  }\n\n  render() {\n    return (\n      <div \n        className=\"permission-selector\"\n        ref={n => this._node = n}>\n\n        <h3>Permission Level\n          <span className=\"close outline-icon\" onClick={this.handleCancel}>{'\\ue897'}</span>\n        </h3>\n        <ul>\n          <li\n            className=\"READ\"\n            onClick={() => this.changeLevel('READ')}>\n            <div className=\"checked\">\n              <div className=\"icon\">\n                {this.props.accessLevel === 'READ' && '\\uf00c' }\n              </div>\n            </div>\n            <h4>Read</h4>\n            <p>Collaborators can read document and annotations, but not edit.</p>\n          </li>\n\n          <li \n            className=\"WRITE\"\n            onClick={() => this.changeLevel('WRITE')}>\n            <div className=\"checked\">\n              <div className=\"icon\">\n                {this.props.accessLevel === 'WRITE' && '\\uf00c' }\n              </div>\n            </div>\n            <h4>Write</h4>\n            <p>Collaborators can read document and annotations, create new annotations, add and reply to comments.</p>\n          </li>\n\n          <li\n            className=\"ADMIN\"\n            onClick={() => this.changeLevel('ADMIN')}>\n            <div className=\"checked\">\n              <div className=\"icon\">\n                {this.props.accessLevel === 'ADMIN' && '\\uf00c' }\n              </div>\n            </div>\n            <h4>Admin</h4>\n            <p>Admins can edit document metadata, invite other collaborators, backup and restore, and roll back the edit history.</p>\n          </li>\n        </ul>\n      </div>\n    )\n  }\n\n}\n\nexport function openSelector(config) {\n  const parent = config.parent;\n  const root = document.createElement('div');\n  parent.append(root);\n\n  const onCancel = () => {\n    root.remove(); \n  }\n\n  const onChangeLevel = (level) => {\n    config.onChangeLevel(level);\n    root.remove();\n  }\n\n  render(\n    <PermissionSelector \n      accessLevel={config.accessLevel}\n      onChangeLevel={onChangeLevel}\n      onCancel={onCancel} />, \n  root);\n}","import React, { Component } from 'react';\nimport { AsyncTypeahead } from 'react-bootstrap-typeahead'; \nimport axios from 'axios';\n\nexport default class UserSearch extends Component {\n\n  state = {\n    isLoading: false,\n    options: [],\n    selected: null,\n    inputValue: null\n  }\n\n  fetchSuggestions = query => {\n    this.setState({isLoading: true});\n    const exclude = this.props.exclude ? this.props.exclude : [];\n    axios.get(`/api/sharing/search?q=${query}`)\n      .then(result => this.setState({\n        isLoading: false,\n        options: result.data.filter(username => !exclude.includes(username))\n      }));\n  }\n\n  onChange = (selected) => {\n    this.setState({ selected: selected });\n  }\n\n  onInputChange = (value) => {\n    this.setState({ inputValue: value });\n  }\n\n  clear = () => {\n    this._input.getInstance().clear();\n    this.setState({ \n      selected: null,\n      inputValue: null\n    });\n  }\n\n  onKeyDown = (evt) => {\n    const { selected, inputValue, options } = this.state;\n    if (evt.which === 13) { // Enter\n      if (selected && selected.length === 1)\n        this.props.onSelect(selected[0]);\n      else if (inputValue && options.includes(inputValue))\n        this.props.onSelect(inputValue);\n    }\n  }\n\n  render() {\n    return (\n      <AsyncTypeahead\n        id=\"typeahead\"\n        ref={r => this._input = r}\n        className=\"user-search\"\n        placeholder={this.props.placeholder || 'Enter username'}\n        selected={this.state.selected}\n        onChange={this.onChange}\n        onInputChange={this.onInputChange}\n        onKeyDown={this.onKeyDown}\n        isLoading={this.state.isLoading}\n        onSearch={this.fetchSuggestions} \n        options={this.state.options} />\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport axios from 'axios';\nimport { openSelector } from './PermissionSelector';\nimport UserSearch from '../../../../common/UserSearch';\n\nexport default class Collaborators extends Component {\n\n  state = {\n    collaborators: []\n  }\n\n  componentDidMount() {\n    axios.get(`/api/sharing/folders/${this.props.item.id}/collaborators`)\n    .then(result => {\n      this.setState({ collaborators: result.data.collaborators });\n    });\n  }\n\n  storeCollaborator = (setting) => {\n    axios.post('/api/sharing/folders/collaborator', {\n      ...setting, ids: [ this.props.item.id ]\n    }).catch(error => {\n      // TODO \n    });\n  }\n  \n  openPermissionsSelector = (evt, collaborator) => {\n    const button = evt.target.nodeName === 'BUTTON' ? evt.target : evt.target.parentNode;\n\n    openSelector({\n      parent: button.parentNode, \n      accessLevel: collaborator.access_level,\n\n      onChangeLevel: level => { \n        const update= { username: collaborator.username, access_level: level } \n        this.storeCollaborator(update);\n        this.setState(prev => {\n          return {\n            collaborators: prev.collaborators.map(c => {\n              return (c.username === collaborator.username) ? update : c;\n            })\n          }\n        }) \n      }\n    });\n  }\n\n  removeCollaborator = collaborator => {\n    this.setState(prev => {\n      return { collaborators: prev.collaborators.filter(c => c.username !== collaborator.username) }\n    });\n\n    axios.delete('/api/sharing/folders/collaborator', { data: {\n      ids: [ this.props.item.id ],\n      username: collaborator.username\n    }}).catch(error => {\n      // TODO\n    });\n  }\n\n  addCollaborator = username => {\n    const update = { username: username, access_level: 'READ' }\n    this.storeCollaborator(update);\n    this.setState(prev => {\n      return { \n        collaborators:  [ ...prev.collaborators, update ]\n      }\n    });\n  }\n\n  render() {\n    const collaborators = this.state.collaborators.map(c => \n      <tr key={c.username}>\n        <td>{c.username}</td>\n        <td>\n          <button\n            className=\"btn small permissions\"\n            onClick={(evt) => this.openPermissionsSelector(evt, c)}>\n            <span className=\"label\">{c.access_level}</span>\n            <span className=\"icon\">{'\\uf0dd'}</span>\n          </button>\n        </td>\n        <td className=\"col-actions remove-collaborator\">\n          <button \n            className=\"nostyle outline-icon\"\n            onClick={() => this.removeCollaborator(c)}>{'\\ue897'}</button>\n        </td>\n      </tr>\n    );\n\n    return (\n      <div className=\"collaborators\">\n        <div className=\"multi-share-section\">\n          <h3>Collaborators</h3>\n          <table className=\"collaborators\">\n            <tbody>\n              {collaborators.length > 0 ? \n                  collaborators : <tr className=\"no-collaborators\"><td>There are no collaborators yet. Enter a username below to add one.</td></tr>\n              }\n            </tbody>\n          </table>\n        </div>\n\n        <div className=\"multi-share-section add-collaborator\">\n          <UserSearch \n            exclude={this.state.collaborators.map(c => c.username)} \n            onSelect={this.addCollaborator} />\n\n          <div className=\"footer\">\n            <button className=\"btn\" onClick={this.props.onClose}>Close</button>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport UserSearch from '../../../../common/UserSearch';\n\nexport default class DistributeCopies extends Component {\n\n  state = {\n    recipients: []\n  }\n\n  removeRecipient = recipient => {\n    this.setState(prev => {\n      return { recipients: prev.recipients.filter(r => r !== recipient) }\n    });\n  }\n\n  addRecipient = recipient => {\n    this.setState(prev => {\n      return { recipients:  [ ...prev.recipients, recipient ] }\n    });\n  }\n  \n  sendCopies = () => {\n    // TODO \n  }\n\n  render() {\n    const recipients = this.state.recipients.map(r => \n      <tr key={r}>\n        <td>\n          {r} \n          <button \n            className=\"nostyle icon remove\"\n            onClick={() => this.removeRecipient(r)}>&#xf00d;</button>\n        </td>\n      </tr>\n    );\n\n    return (\n      <div className=\"distribute-copies\">\n        <h3>Send copies to</h3>\n        \n        <table className=\"recipients\">\n          <tbody>\n            { recipients.length > 0 ? recipients :\n              <tr><td className=\"add-recipients\">Add recipients below</td></tr> }\n          </tbody>\n        </table>\n\n        <UserSearch \n          exclude={this.state.recipients.map(c => c.username)} \n          onSelect={this.addRecipient} />\n\n        <div className=\"footer\">\n          <button\n            className=\"btn\" \n            disabled={recipients.length === 0}\n            onClick={this.sendCopies}>Send now</button>\n\n          <button className=\"btn\" onClick={this.props.onClose}>Close</button>\n        </div>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport Modal from '../../../common/Modal';\nimport PublicAccess from './public/PublicAccess';\nimport Collaborators from './collaborators/Collaborators';\nimport DistributeCopies from './copies/DistributeCopies';\n\nexport default class ShareModal extends Component {\n\n  state = {\n    view: 'PUBLIC_ACCESS'\n  };\n\n  componentDidMount() {\n    document.addEventListener('keydown', this.onKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.onKeydown, false);\n  }\n\n  onKeydown = (evt) => {\n    evt.stopPropagation();\n    if (evt.which === 27) this.props.onClose();\n  }\n\n  setView = (name) => {\n    this.setState({ view: name });\n  }\n\n  getView = () => {\n    if (this.state.view === 'PUBLIC_ACCESS')\n      return <PublicAccess item={this.props.selection.get(0)} onClose={this.props.onClose}/>\n    else if (this.state.view === 'COLLABORATORS')\n      return <Collaborators item={this.props.selection.get(0)} onClose={this.props.onClose} />\n    else if (this.state.view === 'DISTRIBUTE_COPIES')\n      return <DistributeCopies item={this.props.selection.get(0)} onClose={this.props.onClose} />\n  }\n\n  render() {\n    return (\n      <Modal\n        className=\"multi-share-modal\" \n        title=\"Share\"\n        onClose={this.props.onClose}>\n        <div className=\"multi-share\">\n          <div className=\"multi-share-tabs\">\n            <ul>\n              <li \n                className={this.state.view === 'PUBLIC_ACCESS' ? 'active' : ''}\n                onClick={() => this.setView('PUBLIC_ACCESS')} >\n                Public Access\n              </li>\n\n              <li \n                className={this.state.view === 'COLLABORATORS' ? 'active' : ''}\n                onClick={() => this.setView('COLLABORATORS')} >\n                Collaborators\n              </li>\n\n              <li className=\"disabled\">\n                Distribute Copies\n              </li>\n            </ul>\n          </div>\n\n          <div className=\"multi-share-body\">\n            <div className=\"view-container\">\n              { this.getView() }     \n            </div>\n          </div>\n        </div>\n      </Modal>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport axios from 'axios';\nimport Modal from '../../../common/Modal';\nimport { prompt } from '../prompt';\n\nclass NetworkTreeNode extends Component  {\n\n  state = {\n    edits_since: null\n  }\n\n  componentDidMount() {\n    const { cloned_at } = this.props; // null for root\n    if (cloned_at) {\n      axios.get(`/api/document/${this.props.id}/contributions/count?since=${encodeURIComponent(cloned_at)}`)\n        .then(response => this.setState({ edits_since: response.data.contributions }));\n    }\n  }\n\n  merge = () => {\n    const executeMerge = () => {\n      axios.post(`/api/document/${this.props.selected}/merge?from=${this.props.id}`)\n        .then(response => this.props.onMergeComplete());\n\n      // TODO handle errors\n    }\n\n    const message = \n      `This operation will merge annotations from both documents, potentially overwriting \n       edits you have made. Are you sure you want to do this?`;\n\n    prompt({\n      title: 'Merge Annotations',\n      message: message,\n      type: 'WARNING',\n      onConfirm: executeMerge\n    });\n  }\n\n  render() {\n    const { feature_toggles} = this.props.account;\n    const isSelected = this.props.selected === this.props.id;\n\n    return (\n      <li>\n        <span className={isSelected ? 'selected doc-id' : 'doc-id'}>\n          <a href={`/${this.props.owner}`}>\n            { this.props.owner }\n          </a> / <a href={`/document/${this.props.id}`}>\n            { this.props.id }\n          </a>\n        </span>\n        { this.state.edits_since > 0 && \n          <>\n            <span className=\"edits-since\">+ {this.state.edits_since} edits</span>\n            { feature_toggles && feature_toggles.includes('merge-documents') && !isSelected &&\n              <button className=\"merge btn tiny\" onClick={this.merge}>Merge Annotations</button> \n            }\n          </>\n        }\n        { this.props.children && \n          <ul>\n            { this.props.children.map(doc => \n              <NetworkTreeNode \n                key={doc.id} \n                account={this.props.account}\n                selected={this.props.selected} \n                onMergeComplete={this.props.onMergeComplete}\n                {...doc} /> \n            )}\n          </ul>\n        }\n      </li>\n    )\n  }\n\n}\n\nexport default class NetworkModal extends Component {\n\n  state = {\n    network: null\n  }\n\n  componentDidMount() {\n    // Assuming a single-document selection, enforced through the menu component\n    const docId = this.props.selection.get(0).id;\n\n    axios.get(`/api/document/${docId}/network`)\n      .then(response => {\n\n        this.setState({ network: response.data })\n      });\n\n    document.addEventListener('keydown', this.onKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.onKeydown, false);\n  }\n\n  onKeydown = (evt) => {\n    evt.stopPropagation();\n    if (evt.which === 27) this.props.onClose();\n  }\n\n  render() {\n    return (\n      <Modal\n        className=\"explore-network-modal\" \n        title=\"Explore Network\"\n        onClose={this.props.onClose}>\n        <div className=\"explore-network\">\n          { this.state.network && \n            <ul>\n              <NetworkTreeNode \n                account={this.props.account}\n                {...this.state.network.root} \n                selected={this.props.selection.get(0).id} \n                onMergeComplete={this.props.onMergeComplete} />\n            </ul>\n          }\n        </div>\n      </Modal>\n    )\n  }\n\n}\n","import { createFolder, renameFolder } from './folder';\nimport { uploadFiles, importSource } from './importing';\nimport { entityRecognition } from './ner';\nimport { mapKurator } from './mapkurator';\nimport { updateReadme, deleteReadme } from './readme';\nimport { moveSelection } from './move';\nimport { deleteSelection, duplicateSelection } from './selection';\nimport { shareSelection } from './sharing';\nimport { exploreNetwork } from './network';\n\n/** \n * Wraps all operations into one object so that \n * we can import them in one go.\n */\nexport default {\n  createFolder,\n  renameFolder,\n  uploadFiles,\n  importSource,\n  updateReadme,\n  deleteReadme,\n  deleteSelection,\n  moveSelection,\n  duplicateSelection,\n  shareSelection,\n  exploreNetwork,\n  entityRecognition,\n  mapKurator\n};","import React from 'react';\nimport { render } from 'react-dom';\nimport SHINEModal from './SHINEModal';\n\nexport const importFromShine = () => {\n\n  return new Promise(resolve => {\n    const container = document.createElement('div');\n    document.body.appendChild(container);\n\n    const onResolve = files => {\n      container.remove();\n      resolve(files);\n    }\n    \n    render(\n      <SHINEModal \n        onClose={onResolve}\n        onUploadFiles={onResolve} />, container);\n  });\n\n}","import axios from 'axios';\nimport { prompt } from '../prompt';\nimport { alert } from '../alert';\n\nconst deleteFolders = folders => {\n  const ids = folders.map(f => f.id);\n\n  if (ids.length > 0) {\n    return ids.length === 1 ?\n      axios.delete(`/api/folder/${ids[0]}`) : \n      axios.delete(`/api/folder/bulk`, { data: ids });\n  } else {\n    return new Promise((resolve) => { resolve(); });\n  }\n}\n\nconst deleteDocuments = (documents, view) => {\n  const ids = documents.map(d => d.id);\n\n  if (ids.length > 0) {\n    return ids.length === 1 ? (\n      view === 'MY_DOCUMENTS' ? // Delete or unshare \n        axios.delete(`/api/document/${ids[0]}`) : axios.delete(`/api/shared/document/${ids[0]}`) \n    ) : (\n      view === 'MY_DOCUMENTS' ?\n        axios.delete('/api/document/bulk', { data: ids }) : axios.delete('/api/shared/document/bulk', { data: ids })\n    )\n  } else {\n    return new Promise((resolve) => { resolve(); });\n  }\n}\n\nexport const deleteSelection = args => {\n\n  const { \n    selection,\n    view, \n    onStart, \n    onSuccess, \n    onError, \n    onCancel \n  } = args;\n\n  const message = view === 'MY_DOCUMENTS' ?\n    'You are about to permanently delete the selected documents. Are you sure?' :\n    'This will remove the selected documents from your shared documents list. Are you sure?';\n\n  const executeDelete = () => {\n    const folders = selection.getItems().filter(i => i.type === 'FOLDER');\n    const documents = selection.getItems().filter(i => i.type === 'DOCUMENT');\n\n    if (folders.length + documents.length > 0) {\n      onStart();\n\n      deleteDocuments(documents, view)\n        .then(() => deleteFolders(folders))\n        .then(() => {\n          onSuccess();\n        }).catch((error) => {\n          onError(error);\n        });\n    } else {\n      onCancel && onCancel();\n    }\n  }\n\n  prompt({\n    title: 'Delete',\n    message: message,\n    type: 'WARNING',\n    onConfirm: executeDelete,\n    onCancel: onCancel\n  });\n\n}\n\n/** Only supports single documents at them moment **/\nexport const duplicateSelection = selection => {\n  if (selection.isSingleDocument()) {\n    const doc = selection.get(0);\n    return axios.post(`/api/clone/document/${doc.id}`).catch(error => {\n      const message = error.response.status === 409 ? \n        'Oops. Could not duplicate - storage quota exceeded.' :\n        'Oops. Something went wrong.';\n\n      alert({\n        title: 'Error',\n        type: 'WARNING',\n        message: message\n      });\n    });\n  } else {\n    return new Promise((resolve) => { resolve(); });\n  }\n}","import React from 'react';\nimport { render } from 'react-dom';\nimport FolderBrowser from './FolderBrowser';\n\nexport const moveSelection = args => {\n\n  const container = document.createElement('div');\n  document.body.appendChild(container);\n\n  const onComplete = () => {\n    container.remove();\n    args.onComplete();\n  }\n\n  const onCancel = () => {\n    container.remove();\n  }\n\n  render(\n    <FolderBrowser\n      view={args.view}\n      page={args.page}\n      selection={args.selection} \n      onComplete={onComplete}\n      onCancel={onCancel} />, container);\n\n}","import React from 'react';\nimport { render } from 'react-dom';\nimport ShareModal from './ShareModal';\n\nexport const shareSelection = selection => {\n\n  return new Promise(resolve => {\n    const container = document.createElement('div');\n    document.body.appendChild(container);\n\n    const close = url => { \n      container.remove();\n      resolve();\n    }\n\n    render(\n      <ShareModal\n        selection={selection}\n        onClose={close} />, container);\n  });\n\n}","import React from 'react';\nimport { render } from 'react-dom';\nimport NetworkModal from './NetworkModal';\n\nexport const exploreNetwork = (selection, account) => {\n  \n  return new Promise(resolve => {\n    const container = document.createElement('div');\n    document.body.appendChild(container);\n\n    const close = url => { \n      container.remove();\n      resolve();\n    }\n\n    render(\n      <NetworkModal\n        selection={selection}\n        account={account}\n        onClose={close} \n        onMergeComplete={close} />, container);\n  });\n\n}","import React from 'react';\nimport { render } from 'react-dom';\nimport EntityRecognition from './EntityRecognition';\n\nexport const entityRecognition = selection => {\n\n  return new Promise(resolve => {\n    const container = document.createElement('div');\n    document.body.appendChild(container);\n\n    const onComplete = () => {\n      resolve();\n    }\n\n    const onClose = () => {\n      container.remove();\n    }\n\n    render(\n      <EntityRecognition \n        selection={selection}\n        onCancel={onClose} \n        onClose={onClose}\n        onComplete={onComplete} />, container);\n  });\n\n}","import React from 'react';\nimport { render } from 'react-dom';\nimport MapKurator from './MapKurator';\n\nexport const mapKurator = selection => {\n\n  return new Promise(resolve => {\n    const container = document.createElement('div');\n    document.body.appendChild(container);\n\n    const onComplete = () =>\n      resolve();\n\n    const onClose = () =>\n      container.remove();\n\n    render(\n      <MapKurator \n        selection={selection}\n        onClose={onClose}\n        onComplete={onComplete} />, container);\n  });\n\n}","import React, { Component } from 'react';\n\nconst MenuGroup = props => {\n\n  const classNames = props.className ? \n    [ 'group', props.className ] : [ 'group']\n\n  return (\n    <li\n      className={classNames.join(' ')}>\n      <ul>\n        {props.children}\n      </ul>\n    </li>\n  );\n\n}\n\nconst MenuItem = props => {\n\n  return (\n    <li\n      key={props.label}\n      className={`option${props.disabled ? ' disabled' : '' }`}\n      onClick={(props.disabled || !props.onSelect) ? null : props.onSelect}>\n\n      {props.link ? \n        <a href={props.link}>\n          {props.icon && <span className=\"icon\">{props.icon}</span> } {props.label}\n        </a>\n        : \n        <span>\n          {props.icon && <span className=\"icon\">{props.icon}</span>} {props.label}\n        </span>\n      }\n    </li>\n  );\n\n}\n\nclass Menu extends Component {\n\n  constructor(props) {\n    super(props);\n    this.onMousedown = this.onMousedown.bind(this);\n    this.onKeydown = this.onKeydown.bind(this);\n  }\n\n  componentDidMount() {\n    document.addEventListener('mousedown', this.onMousedown, false);\n    document.addEventListener('keydown', this.onKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('mousedown', this.onMousedown, false);\n    document.removeEventListener('keydown', this.onKeydown, false);\n  }\n\n  onMousedown(evt) {\n    const isClickOutside = !this._node.contains(evt.target);\n    if (isClickOutside) this.props.onCancel();\n  }\n\n  onKeydown(evt) {\n    if (evt.which === 27) this.props.onCancel();\n  }\n\n  render() {\n    return (\n      <div\n        ref={n => this._node = n}\n        className={`modal-menu ${this.props.className}`}>\n        <ul>\n          { this.props.children }\n        </ul>\n      </div>\n    )\n  }\n\n}\n\nMenu.Group = MenuGroup;\nMenu.Item = MenuItem;\n\nexport default Menu;\n","import React, { Component } from 'react';\nimport UserSearch from '../../../common/UserSearch';\n\nconst INITIAL_STATE = {\n  query        : '',\n  in           : 'ALL',     // 'MY', 'SHARED'\n  type         : 'ANY',     // 'TEXT', 'IMAGE', 'TABLE'\n  owner        : '',\n  lastModified : 'ANYTIME', // 'WEEK' \n};\n\nexport default class AdvancedSearch extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = { ...INITIAL_STATE }\n\n    this.onMousedown = this.onMousedown.bind(this);\n    this.onKeydown = this.onKeydown.bind(this);\n  }\n\n  componentDidMount() {\n    document.addEventListener('mousedown', this.onMousedown, false);\n    document.addEventListener('keydown', this.onKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('mousedown', this.onMousedown, false);\n    document.removeEventListener('keydown', this.onKeydown, false);\n  }\n\n  onMousedown(evt) {\n    const isClickOutside = !this._node.contains(evt.target);\n    const isClickOnToggle = evt.target.classList.contains('advanced');\n    if (isClickOutside && !isClickOnToggle) this.props.onClose();\n  }\n\n  onKeydown(evt) {\n    if (evt.which === 27) this.props.onClose();\n  }\n\n  onChangeSearchIn = evt => this.setState({ in: evt.target.value });\n\n  onChangeDocType = evt => this.setState({ type: evt.target.value });\n\n  onChangeOwner = owner => this.setState({ owner: owner });\n\n  onChangeQuery = evt => this.setState({ query: evt.target.value });\n\n  onChangeLastModified = evt => this.setState({ lastModified: evt.target.value });\n\n  onClear = evt => { \n    evt.preventDefault();\n    this.setState({ ...INITIAL_STATE });\n  }\n\n  onSearch = evt => {\n    evt.preventDefault();\n    this.props.onSearch(this.state);\n  }\n\n  render() {\n    return (\n      <div\n        ref={n => this._node = n}\n        className=\"advanced-search\">\n        <button\n          className=\"close nostyle\"\n          onClick={this.props.onClose}>&#xe897;</button>\n\n        <form>\n          <fieldset>\n            <div className=\"field\">\n              <label>Search in</label>\n              <select\n                value={this.state.searchIn}\n                onChange={this.onChangeSearchIn}>\n                <option value=\"ALL\">All of Recogito</option>\n                <option value=\"MY\">My documents</option>\n                <option value=\"SHARED\">Shared with me</option>\n              </select>\n              <span className=\"hint\" />\n            </div>\n\n            <div className=\"field\">\n              <label>Document type</label>\n              <select\n                value={this.state.docType}\n                onChange={this.onChangeDocType}>\n                <option value=\"ANY\">Any</option>\n                <option value=\"TEXT\">Text</option>\n                <option value=\"IMAGE\">Image</option>\n                <option value=\"TABLE\">Table</option>\n              </select>\n              <span className=\"hint\" />\n            </div>\n\n            <div className=\"field\">\n              <label>Owner</label>\n              <UserSearch\n                onSelect={this.onChangeOwner} />\n              <span className=\"hint\" />\n            </div>\n\n            <div className=\"field\">\n              <label>Metadata contains</label>\n              <input \n                type=\"text\" \n                value={this.state.query} \n                onChange={this.onChangeQuery} />\n              <span className=\"hint\" />\n            </div>\n\n            <div className=\"field\">\n              <label>Last modified</label>\n              <select \n                value={this.state.lastModified}\n                onChange={this.onChangeLastModified}>\n                <option value=\"ANYTIME\">Any time</option>\n                <option value=\"WEEK\">this week</option>\n              </select>\n              <span className=\"hint\" />\n            </div>\n          </fieldset>\n\n          <fieldset className=\"buttons\">\n            <button type=\"button\" className=\"nostyle clear\" onClick={this.onClear}>Clear</button>\n            <button type=\"button\" className=\"btn\" onClick={this.onSearch}>Search</button>\n          </fieldset>\n        </form>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport axios from 'axios';\n\nimport AdvancedSearch from './AdvancedSearch.jsx';\n\nconst SCOPE_NAMES = {\n  MY_DOCUMENTS   : 'my',\n  SHARED_WITH_ME : 'shared'\n} \n\nexport default class Search extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = { \n      query: '',\n      advancedSearchOpen: false \n    };\n    this._rootEl = document.getElementById('app');\n  }\n\n  componentDidMount() {\n    this._rootEl.addEventListener('keydown', this.onKeydown, false);\n  }\n\n  /** Remove deselect listeners **/\n  componentWillUnmount() {\n    this._rootEl.removeEventListener('keydown', this.onKeydown, false);\n  }\n\n  onKeydown = evt => {\n    if (evt.which === 27 && this.props.searchScope) {\n      this.setState({ query: '' });\n      this.props.onQuit();\n    }\n  }\n\n  toggleAdvancedSearch = () => {\n    this.setState(prev => ({ \n      advancedSearchOpen: !prev.advancedSearchOpen,\n      query: ''\n    }));\n  }\n\n  executeSearch = args => {\n    const data = {\n      ...args,\n      ...this.props.tableConfig\n    };\n\n    axios.post('/api/search', data).then(result => {\n      this.props.onResponse(result.data);\n    });\n  }\n\n  onSearch = evt => {\n    const query = evt.target.value;\n    this.setState({ query: query });\n\n    if (query.length === 0) {\n      this.props.onQuit();\n    } else if (query.length > 1) {\n      const scope = this.props.searchScope ? \n        this.props.searchScope : this.props.view;\n\n      this.executeSearch({\n        q: query,\n        in: SCOPE_NAMES[scope]\n      });\n    }\n  }\n\n  advancedSearch = settings => {\n    const args = {\n      q     : settings.query ? settings.query : null, // Discard empty strings\n      in    : settings.in,\n      type  : settings.type,\n      owner : settings.owner ? settings.owner : null, // same\n    }\n\n    this.setState({ advancedSearchOpen: false}, \n      () => this.executeSearch(args));\n  }\n\n  render() {\n    const placeholder = this.props.view === 'MY_DOCUMENTS' ?\n      'Search my workspace' : \n      this.props.view === 'SHARED_WITH_ME' ? 'Search shared documents' : '';\n\n    return (\n      <div className=\"wrapper\">\n        <div className=\"search\">\n          <div className=\"wrapper\">\n            <input\n              placeholder={placeholder}\n              value={this.state.query}\n              onChange={this.onSearch} />\n            <button\n              className=\"icon nostyle advanced\"\n              onClick={this.toggleAdvancedSearch.bind(this)}>{'\\ue688'}</button>\n          </div>\n          <span className=\"icon hand-lens\">&#xf002;</span>\n        </div>\n        {this.state.advancedSearchOpen &&\n          <AdvancedSearch \n            account={this.props.account}\n            onSearch={this.advancedSearch}\n            onClose={this.toggleAdvancedSearch}/>\n        }\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport { CSSTransition } from 'react-transition-group';\nimport Breadcrumbs from '../../common/header/Breadcrumbs';\nimport HeaderIcon from '../../common/header/HeaderIcon';\nimport Menu from  '../../common/Menu';\nimport Search from './search/Search';\n\nconst OptionsMenu = props => {\n\n  const canDuplicate = // Single document in my workspace\n    props.selection.isSingleDocument() && props.view === 'MY_DOCUMENTS';\n\n  const canShare = // Single folder in my workspace\n    props.selection.isSingleFolder() && props.view === 'MY_DOCUMENTS';\n\n  const hasNetwork = // Single document with 'has_clones' or 'cloned_from'\n    props.selection.isSingleDocument() &&\n    (props.selection.get(0).has_clones || props.selection.get(0).cloned_from);\n\n  const openInNewTab = () => {\n    window.open(`document/${props.selection.get(0).id}/part/1/edit`, '_blank');\n    props.onCancel();\n  }\n\n  const feature_toggles = props.account.feature_toggles || [];\n\n  const hasMapKurator = true; // feature_toggles.includes('mrm');\n\n  // TODO probably worth splitting this up into a separate source file, or\n  // perhaps two (one OptionsMenu container & one presentational component)\n  return (\n    <Menu \n      className=\"selection-options-menu\"\n      onCancel={props.onCancel}>\n\n      <Menu.Group>\n        <Menu.Item \n          label=\"Open\" \n          disabled={!props.selection.isSingleSelection()} \n          link={props.selection.isSingleSelection() && `document/${props.selection.get(0).id}/part/1/edit`} />\n\n        <Menu.Item \n          label=\"Open in new tab\" \n          disabled={!props.selection.isSingleDocument()} \n          onSelect={openInNewTab} />\n      </Menu.Group>\n      \n      <Menu.Group>\n        <Menu.Item\n          icon={'\\uf114'}\n          label=\"Move to\"\n          onSelect={props.onMoveSelection} />\n\n        <Menu.Item\n          icon={'\\uf0c5'}\n          label=\"Duplicate\"\n          disabled={!canDuplicate}\n          onSelect={props.onDuplicateSelection} />\n\n        <Menu.Item \n          icon={'\\uf014'} \n          label=\"Delete\"\n          onSelect={props.onDeleteSelection} /> \n      </Menu.Group>\n\n      <Menu.Group>\n        <Menu.Item \n          icon={'\\uf234'}\n          label=\"Share\" \n          disabled={!canShare} \n          onSelect={props.onShareSelection} />\n\n        <Menu.Item\n          icon={'\\uf126'} \n          disabled={!hasNetwork}\n          label=\"Explore network\" \n          onSelect={props.onExploreNetwork} />\n      </Menu.Group>\n\n      <Menu.Group>\n        <Menu.Item \n          icon={'\\uf085'} \n          label=\"Named Entity Recognition\" \n          disabled={!props.selection.includesText()} \n          onSelect={props.onNER} />\n\n        {hasMapKurator && \n          <Menu.Item \n            icon={'\\uf278'} \n            label=\"mapKurator\" \n            disabled={props.selection.includesText()} \n            onSelect={props.onMapKurator} />\n        }\n      </Menu.Group>\n    </Menu>\n  );\n\n}\n\nexport default class Header extends Component {\n\n  state = {\n    optionsMenuVisible: false\n  }\n\n  showOptionsMenu = () => {\n    this.setState({ optionsMenuVisible: true });\n  }\n\n  closeOptionsMenu = () => {\n    this.setState({ optionsMenuVisible: false });\n  }\n\n  /** Helper that closes the menu and executes a select action **/\n  closeAndThen = fn => {\n    return args => {\n      this.setState({ optionsMenuVisible: false });\n      fn(args);\n    }\n  }\n\n  render() {\n    const hasSelection = !this.props.selection.isEmpty();\n\n    return (\n      <div className={this.props.readme ? \"header\" : \"header no-readme\"}>\n        <div className=\"top-row\">\n          <Search\n            account={this.props.account}\n            view={this.props.view}\n            presentation={this.props.presentation}\n            searchScope={this.props.searchScope}\n            tableConfig={this.props.tableConfig} \n            onResponse={this.props.onSearchResponse} \n            onQuit={this.props.onQuitSearch} />\n\n          <div className=\"header-icons\">\n            <HeaderIcon icon=\"&#xe64a;\" className=\"help stroke7\" link=\"/help\" />\n          </div>\n        </div>\n\n        <div className=\"main-header\">\n          <Breadcrumbs \n            view={this.props.view}\n            path={this.props.breadcrumbs}\n            docCount={this.props.docCount}>\n\n            {!this.props.readme && this.props.view === 'MY_DOCUMENTS' &&\n              <button \n                className=\"add-abstract nostyle\"\n                onClick={this.props.onCreateReadme} >\n                <span className=\"icon\">&#xf055;</span>\n                <span className=\"label\">Add a description...</span>\n              </button>\n            }\n          </Breadcrumbs>\n\n          <div className=\"main-header-icons\">\n           <CSSTransition\n              in={hasSelection} \n              timeout={200} \n              classNames=\"selection-options\">\n\n              <div \n                className=\"selection-options\"\n                onClick={this.showOptionsMenu}>              \n                <span className=\"label\">Options</span>\n                <span className=\"more icon\">&#xf078;</span>\n              </div>\n            </CSSTransition>\n\n            { this.state.optionsMenuVisible &&\n              <OptionsMenu\n                account={this.props.account} \n                view={this.props.view} \n                selection={this.props.selection} \n                onMoveSelection={this.closeAndThen(this.props.onMoveSelection)}\n                onDuplicateSelection={this.closeAndThen(this.props.onDuplicateSelection)}\n                onDeleteSelection={this.closeAndThen(this.props.onDeleteSelection)} \n                onShareSelection={this.closeAndThen(this.props.onShareSelection)}\n                onExploreNetwork={this.closeAndThen(this.props.onExploreNetwork)}\n                onNER={this.closeAndThen(this.props.onNER)}\n                onMapKurator={this.closeAndThen(this.props.onMapKurator)}\n                onCancel={this.closeOptionsMenu} /> }\n\n            <HeaderIcon\n              className=\"presentation-toggle stroke7\"\n              icon={this.props.presentation === 'TABLE' ? '\\ue645' : '\\ue636'} \n              onClick={this.props.onTogglePresentation} />\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport Menu from '../../../common/Menu';\nimport IdentityInfo from '../../../common/account/IdentityInfo';\n\nexport default class Account extends Component {\n\n  state = {\n    menuVisible: false \n  };\n\n  openMenu = () => {\n    this.setState({ menuVisible: true });\n  }\n\n  closeMenu = () => {\n    this.setState({ menuVisible: false });\n  }\n\n  render() {\n    return (\n      <div\n        className=\"section account\"\n        onClick={this.openMenu} >\n\n        <IdentityInfo \n          account={this.props.account} />\n\n        { this.state.menuVisible &&\n          <Menu \n            className=\"account-menu\"\n            onCancel={this.closeMenu}>\n\n            <Menu.Group >\n              <Menu.Item icon={'\\uf0ad'} label=\"Account settings\" link=\"/settings/account\" />\n            </Menu.Group>\n            \n            <Menu.Group>\n              <Menu.Item icon={'\\uf128'} label=\"Help\" link=\"/help\" />\n              <Menu.Item icon={'\\uf011'} label=\"Sign out\" link=\"/logout\" />\n            </Menu.Group>\n          </Menu>\n        }\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport Menu from '../../../common/Menu';\n\nexport default class NewContent extends Component {\n\n  state = { \n    menuVisible: false,\n\n  };\n\n  onOpenMenu = () => {\n    this.setState({ menuVisible: true });\n  }\n\n  onCloseMenu = () => {\n    this.setState({ menuVisible: false });\n  }\n\n  onOpenFileExplorer = () => {\n    this._input.click(); // Trigger the hidden file input field\n  }\n\n  onUploadFiles = evt => {\n    const files = Array.from(evt.target.files);\n    this.props.onUploadFiles(files);\n  }\n\n  /** Helper to execute a function after closing the menu **/\n  select = (fn) => {\n    return () => {\n      this.setState({ menuVisible: false });\n      fn();\n    }\n  }\n  \n  hasFeature = name => {\n    return this.props.account.feature_toggles && this.props.account.feature_toggles.includes(name);\n  }\n\n  hasAnyFeature = names => {\n    if (!this.props.account.feature_toggles)\n      return false;\n\n    const toggles = new Set(this.props.account.feature_toggles);\n    const intersection = names.filter(n => toggles.has(n));\n    \n    return intersection.length > 0;\n  }\n\n  render() {\n    return (\n      <div className=\"section create-new\">\n        <button\n          className=\"btn create-new\"\n          onClick={this.onOpenMenu}>\n          <span className=\"icon\">&#xf067;</span>\n          <span className=\"label\">New</span>\n        </button>\n        \n        <input\n          ref={c => this._input = c}\n          type=\"file\"\n          name=\"file\"\n          multiple\n          onChange={this.onUploadFiles}\n          style={{ display: 'none' }} />\n\n        {this.state.menuVisible &&\n          <Menu \n            className=\"create-new\"\n            onCancel={this.onCloseMenu}>\n            \n            <Menu.Group>\n              <Menu.Item \n                icon={'\\uf07b'} \n                label=\"Folder\" \n                onSelect={this.select(this.props.onCreateFolder)} />\n\n              <Menu.Item \n                icon={'\\uf15b'} \n                label=\"File upload\" \n                onSelect={this.select(this.onOpenFileExplorer)} />\n            </Menu.Group>\n\n            <Menu.Group>\n              <Menu.Item \n                icon={'\\uf0c1'} \n                label=\"From IIIF manifest\" \n                onSelect={this.select(() => this.props.onImportSource('IIIF'))} />\n\n              <Menu.Item \n                icon={'\\uf121'} \n                label=\"From CTS service\" \n                onSelect={this.select(() => this.props.onImportSource('CTS'))} />\n\n              <Menu.Item \n                icon={'\\uf0f6'} \n                label=\"From RISE Repository\" \n                onSelect={this.select(() => this.props.onImportSource('SHINE'))} />\n\n              {/* this.hasAnyFeature(['webmaps', 'mrm' ]) && */} <Menu.Item\n                icon={'\\uf278'}\n                label=\"WMTS Web Map Service\"\n                onSelect={this.select(() => this.props.onImportSource('WEBMAP'))} />\n              {/* } */}\n            </Menu.Group>\n          </Menu>\n        }\n      </div>\n    )\n  }\n\n}\n","import React from 'react';\n\nconst ViewListItem = props => {\n\n  return (\n    <li\n      className={props.current ? 'current' : null}\n      onClick={props.onClick}>\n      <span className=\"icon\">{props.icon}</span> {\n        props.children\n      }\n    </li>\n  );\n\n}\n\nconst Views = props => {\n  \n  return (\n    <div className=\"section views\">\n      <ul>\n        <ViewListItem\n          icon=\"&#xf2be;\"\n          current={props.view === 'MY_DOCUMENTS'}\n          onClick={() => props.onChangeView('MY_DOCUMENTS')}>\n          My Documents\n        </ViewListItem>\n\n        <ViewListItem\n          icon=\"&#xf064;\"\n          current={props.view === 'SHARED_WITH_ME'}\n          onClick={() => props.onChangeView('SHARED_WITH_ME')}>\n          Shared with me\n        </ViewListItem>\n      </ul>\n    </div>\n  );\n\n}\n\nexport default Views;","import React from 'react';\nimport NumberFormat from 'react-number-format';\nimport Meter from '../../../common/Meter.jsx';\n\nconst Storage = props => {\n\n  const dataAvailable = props.account && props.account.storage;\n  const quota = dataAvailable ? props.account.storage.quota_mb : 0;\n  const used = dataAvailable ? props.account.storage.used_mb : 0;\n\n  return (\n    <div className=\"section storage\">\n      <span className=\"icon\">&#xf1c0;</span> Storage\n      <div className=\"used-diskspace\">\n        <Meter\n          value={(quota > 0) ? Math.min(1, used / quota) : 0} />\n\n        <div className=\"label\">\n          <NumberFormat \n            displayType=\"text\"\n            value={used}\n            thousandSeparator={true} /> \n          {' of  '}\n          <NumberFormat \n            displayType=\"text\"\n            value={quota}\n            thousandSeparator={true} /> MB used\n        </div>\n      </div>\n    </div>\n  );\n\n}\n\nexport default Storage;\n","import React from 'react';\nimport ActivityHistory from '../../../common/account/ActivityHistory';\nimport TopCollaborators from '../../../common/account/TopCollaborators';\n\nconst MyActivity = props => {\n  \n  return (\n    <React.Fragment>\n      <ActivityHistory \n        className=\"section\" \n        width={237}\n        height={55}\n        fill=\"#4483c4\"\n        stats={props.account && props.account.stats} />\n\n      <TopCollaborators \n        className=\"section collaborators\"\n        title=\"My top collaborators\"\n        username={props.account && props.account.username} />\n    </React.Fragment>\n  );\n\n}\n\nexport default MyActivity;","import React from 'react';\nimport Account from './sections/Account';\nimport NewContent from './sections/NewContent';\nimport Views from './sections/Views';\nimport Storage from './sections/Storage';\nimport MyActivity from './sections/MyActivity';\n\nconst Sidebar = props => {\n\n  return (\n    <div className=\"sidebar\">\n      <Account \n        account={props.account} />\n\n      <NewContent \n        account={props.account}\n        onCreateFolder={props.onCreateFolder} \n        onUploadFiles={props.onUploadFiles} \n        onImportSource={props.onImportSource} /> \n\n      <Views\n        view={props.view} \n        onChangeView={props.onChangeView} />\n      \n      <Storage\n        account={props.account} />\n\n      <MyActivity \n        account={props.account} />\n    </div>\n  );\n\n}\n\nexport default Sidebar;\n","import React from 'react';\n\nimport Header from './header/Header';\nimport Readme from '../common/documents/Readme';\nimport Sidebar from './sidebar/Sidebar';\nimport GridPane from '../common/documents/grid/GridPane';\nimport TablePane from '../common/documents/table/TablePane';\n\nconst Workspace = props => {\n\n  return (\n    <React.Fragment>\n      <Sidebar\n        account={props.account}\n        view={props.view}\n        onChangeView={props.onChangeView}\n        onCreateFolder={props.onCreateFolder}\n        onUploadFiles={props.onUploadFiles}\n        onImportSource={props.onImportSource} />\n\n      <div className=\"main-content\">\n        <Header\n          account={props.account}\n          view={props.view}\n          presentation={props.presentation}\n          searchScope={props.searchScope}\n          tableConfig={props.tableConfig}\n          readme={props.page.readme}\n          breadcrumbs={props.page.breadcrumbs}\n          docCount={props.page.total_count}\n          selection={props.selection}\n          onTogglePresentation={props.onTogglePresentation} \n          onCreateReadme={props.onCreateReadme} \n          onMoveSelection={props.onMoveSelection}\n          onDuplicateSelection={props.onDuplicateSelection}\n          onDeleteSelection={props.onDeleteSelection} \n          onShareSelection={props.onShareSelection} \n          onExploreNetwork={props.onExploreNetwork}\n          onNER={props.onNER} \n          onMapKurator={props.onMapKurator}\n          onSearchResponse={props.onSearchResponse}\n          onQuitSearch={props.onQuitSearch} />\n\n        { props.page.readme && \n          <Readme\n            content={props.page.readme} \n            onUpdate={props.onUpdateReadme} \n            onDelete={props.onDeleteReadme} />\n        }\n\n        { props.presentation === 'TABLE' &&\n          <TablePane\n            items={props.page.items}\n            config={props.tableConfig}\n            selection={props.selection}\n            busy={props.busy}\n            enableFiledrop={props.view === 'MY_DOCUMENTS'} \n            onSelect={props.onSelect} \n            onSort={props.onSortTable}\n            onChangeColumnConfig={props.onChangeColumnConfig} \n            onRenameFolder={props.onRenameFolder}\n            onDropFiles={props.onUploadFiles} \n            onDropSourceURL={url => props.onImportSource(null, url)} />\n        }\n\n        { props.presentation === 'GRID' &&\n          <GridPane\n            items={props.page.items}\n            selection={props.selection}\n            busy={props.busy}\n            enableFiledrop={props.view !== 'MY_DOCUMENTS'} \n            onSelect={props.onSelect} \n            onDropFiles={props.onUploadFiles} \n            onDropSourceURL={url => props.onImportSource(null, url)} />            \n        }\n      </div>\n    </React.Fragment>\n  );\n\n}\n\nexport default Workspace;","import React, { Component } from 'react';\nimport { render } from 'react-dom';\nimport axios from 'axios';\nimport { Columns } from '../common/documents/table/Columns';\nimport { initialState, persistState } from './initialState';\nimport operations from './operations';\nimport Selection from '../common/documents/Selection';\nimport Workspace from './Workspace';\n\nimport '../../assets/style/workspace/index.scss';\n\nexport default class App extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = initialState();\n\n    this._rootEl = document.getElementById('app');\n    window.onhashchange = this.changeFolder;\n  }\n\n  /** Init: add deselect listeners and load contents */\n  componentDidMount() {\n    this._rootEl.addEventListener('keydown', this.onKeydown, false);\n    this._rootEl.addEventListener('mousedown', this.onMousedown, false);\n\n    // Init account data\n    axios.get('/api/account/my').then(result => { \n      this.setState({ account: result.data }) \n    }).then(() => {\n      this.refreshPage();\n    });\n  }\n\n  /** Remove deselect listeners **/\n  componentWillUnmount() {\n    this._rootEl.removeEventListener('keydown', this.onKeydown, false);\n    this._rootEl.removeEventListener('mousedown', this.onMousedown, false);\n  }\n\n  onKeydown = evt => {\n    if (evt.which === 27) {\n      // Escape clears selection and quits search\n      this.setState({ selection: new Selection() });\n    } else if (evt.which === 46 && !this.state.selection.isEmpty()) {\n      // Delete key\n      this.deleteSelection();\n    }\n  }\n\n  /** Clear selection on click ouside the document pane **/\n  onMousedown = evt => {\n    const isClickOutside = !(\n      document.querySelector('.documents-pane').contains(evt.target) ||\n      document.querySelector('.main-header-icons').contains(evt.target)\n    );\n\n    if (isClickOutside) this.setState({ selection: new Selection() });\n  }\n\n  /** \n   * Refreshes the current page.\n   * \n   * Note that this doesn't work if the view is currently SEARCH.\n   */\n  refreshPage = () => {\n    this.setState({ busy: true });\n\n    const folderId = document.location.hash.substring(1);\n\n    const path = (this.state.view === 'MY_DOCUMENTS') ?\n       (folderId) ? `my/${folderId}` : 'my' :\n       (folderId) ? `my/shared/${folderId}` : 'my/shared';\n\n    const config = this.state.presentation === 'GRID' ? null :\n      {\n        columns: Columns.expandAggregatedColumns(this.state.table_config.columns),\n        sort: this.state.table_config.sorting.by ? this.state.table_config.sorting : null\n      };\n\n    return axios.post(`/api/directory/${path}`, config).then(result => {\n      this.setState(prev => {\n        const { breadcrumbs, readme, total_count, items } = result.data;\n        return {\n          page : {\n            ...prev.page,\n            ...{\n              breadcrumbs,\n              readme,\n              total_count,\n              items\n            }\n          },\n          busy: false\n        } \n      });\n    });\n  }\n\n  changeFolder = () => {\n    this.setState({ selection: new Selection() }, () => {\n      this.refreshPage();\n    });\n  }\n  \n  changeView = view => {\n    persistState('view', view);\n    this.setState({ \n      view: view,\n      search_scope: null\n    }, this.refreshPage);\n  }\n\n  togglePresentation = () => {\n    this.setState(prev => { \n      const presentation = (prev.presentation === 'TABLE') ? 'GRID' : 'TABLE';\n      persistState('presentation', presentation);\n      return { presentation: presentation };\n    });\n  }\n\n  select = selection => {\n    this.setState({ selection: selection });\n  }\n\n  sortTable = (sorting) => {\n    this.setState(prev => {\n      const config = { ...prev.table_config, ...{ sorting: sorting } };\n      persistState('table_config', config);\n      return { table_config: config };\n    }, () => {\n      this.refreshPage();\n    });      \n  }\n\n  changeColumConfig = columns => {\n    this.setState(prev => { \n      const config = {...prev.table_config, ...{ columns: columns } };\n      persistState('table_config', config);\n      return { table_config: config };\n    });\n  }\n\n  createReadme = () => {\n    this.setState(prev => {\n      return { page: {...prev.page, ...{ readme: true }} }\n    });\n  }\n\n  updateReadme = (readme) => {\n    operations.updateReadme(readme, this.state.page).then(page => {\n      this.setState({ page: page });\n    });\n  }\n\n  deleteReadme = () => {\n    operations.deleteReadme(this.state.page).then(page => {\n      this.setState({ page: page });\n    });\n  }\n\n  moveSelection = () => {\n    operations.moveSelection({\n      view: this.state.view,\n      page: this.state.page,\n      selection: this.state.selection,\n      onComplete: this.refreshPage\n    });\n  }\n\n  duplicateSelection = () => {\n    this.setState({ busy: true });\n    operations.duplicateSelection(this.state.selection)\n      .then(this.refreshPage)\n  }\n\n  deleteSelection = () => {\n    operations.deleteSelection({\n      selection: this.state.selection,\n      view: this.state.view,\n      onStart: () => this.setState({ busy: true }),\n      onSuccess: this.refreshPage,\n      onError:   this.refreshPage\n    });\n  }\n\n  onSearchResponse = response => {\n    this.setState(prev => {\n      return { \n        view: 'SEARCH',\n        search_scope: prev.search_scope ? prev.search_scope : prev.view,\n        page: {\n          breadcrumbs: null,\n          readme: null,\n          total_count: response.total,\n          items: response.items\n        }\n      }\n    });\n  }\n\n  onQuitSearch = () => {\n    this.changeView(this.state.search_scope);\n  }\n\n  render() {\n    return(\n      <Workspace \n        account={this.state.account}\n        view={this.state.view}\n        presentation={this.state.presentation}\n        searchScope={this.state.search_scope}\n        page={this.state.page}\n        tableConfig={this.state.table_config}\n        selection={this.state.selection}\n        busy={this.state.busy}\n        onChangeView={this.changeView}\n        onTogglePresentation={this.togglePresentation}\n        onSelect={this.select}\n        onSortTable={this.sortTable}\n        onChangeColumnConfig={this.changeColumConfig}\n        onCreateReadme={this.createReadme}\n        onUpdateReadme={this.updateReadme}\n        onDeleteReadme={this.deleteReadme}\n        onCreateFolder={() => operations.createFolder().then(this.refreshPage)}\n        onRenameFolder={(folder, title) => operations.renameFolder(folder, title).then(this.refreshPage)}\n        onMoveSelection={this.moveSelection}\n        onDuplicateSelection={this.duplicateSelection}\n        onDeleteSelection={this.deleteSelection}\n        onShareSelection={() => operations.shareSelection(this.state.selection)}\n        onExploreNetwork={() => operations.exploreNetwork(this.state.selection, this.state.account)}\n        onNER={() => operations.entityRecognition(this.state.selection).then(this.refreshPage)}\n        onMapKurator={() => operations.mapKurator(this.state.selection).then(this.refreshPage)}\n        onSearchResponse={this.onSearchResponse}\n        onQuitSearch={this.onQuitSearch}\n        onUploadFiles={files => operations.uploadFiles(files).then(this.refreshPage)}\n        onImportSource={(sourceType, url) => operations.importSource(sourceType, url).then(this.refreshPage)} />\n    )\n  }\n\n}\n\nrender(<App />, document.getElementById('app'));\n","import React from 'react';\n\nconst HeaderIcon = props => {\n\n  return (\n    <div\n      className={`header-icon ${props.className}`}\n      onClick={props.onClick}>\n      {(props.link) ? \n        <a href={props.link} className=\"icon inner\">\n          {props.icon}\n        </a> :\n\n        <span className=\"icon inner\">\n          {props.icon}\n        </span>\n      }\n    </div>\n  );\n\n}\n\nexport default HeaderIcon;","import React from 'react';\n\nconst VIEW_LABELS = {\n  MY_DOCUMENTS: 'My Documents',\n  SHARED_WITH_ME: 'Shared with me',\n  SEARCH: 'Search results'\n}\n\nconst Breadcrumbs = props => {\n  const title = props.view ? VIEW_LABELS[props.view] : props.label;\n\n  return (\n    <div className=\"breadcrumbs\">\n      <h2>\n        <a className=\"root\" href=\"#\">{title}</a>\n        {props.path && props.path.map(b => \n          <a className=\"folder\" href={`#${b.id}`} key={b.id}>{b.title}</a>\n        )}\n      </h2>\n      \n      { props.docCount !== null && props.docCount !== undefined &&\n        <span className=\"count\">{`(${props.docCount})`}</span> }\n\n      { props.children }\n    </div>\n  );\n\n}\n\nexport default Breadcrumbs;","import React, { Component } from 'react';\nimport ReactMarkdown from 'react-markdown';\nimport ContentEditable from 'react-sane-contenteditable';\n\nconst INITIAL_STATE = {\n  editing: false,\n  modifiedContent: null\n}\n\nexport default class Readme extends Component {\n\n  state = {};\n\n  onKeydown = (evt) => {\n    if (evt.which === 27) // Esc\n      this.onCancel(); \n    else if (evt.ctrlKey && evt.which === 13) // Ctrl+Enter \n      this.onSave();\n  }\n\n  onEdit() {\n    document.addEventListener('keydown', this.onKeydown, false);\n    this.setState({ editing: true });\n  }\n\n  onChange(_, value) {\n    this.setState({ modifiedContent: value });\n  }\n\n  onDelete() {\n    document.removeEventListener('keydown', this.onKeydown, false);\n    this.props.onDelete && this.props.onDelete();\n  }\n\n  onSave() {\n    document.removeEventListener('keydown', this.onKeydown, false);\n    this.props.onUpdate && this.props.onUpdate(this.state.modifiedContent);\n    this.setState(INITIAL_STATE);\n  }\n\n  onCancel() {\n    document.removeEventListener('keydown', this.onKeydown, false);\n    if (typeof this.props.content === 'boolean')\n      this.onDelete();\n    else\n      this.setState(INITIAL_STATE);\n  }\n\n  renderView(content) {\n    return (\n      <div className=\"readme\">\n        <div className=\"wrapper\">\n          <div className=\"textbox\">\n            <ReactMarkdown source={content} />       \n          </div>\n\n          {this.props.onUpdate && this.props.onDelete &&\n            <span className=\"buttons modify\">\n              <button\n                className=\"icon nostyle\"\n                title=\"Edit\"\n                onClick={this.onEdit.bind(this)}>&#xf040;</button>\n            </span>\n          }\n        </div>\n      </div>\n    )\n  }\n\n  renderEdit(content) {\n    return (\n      <div className=\"readme editing\">\n        <div className=\"wrapper\">\n          <ContentEditable \n            tagName=\"div\"\n            className=\"textbox\"\n            content={content} \n            editable={true} \n            multiLine={true}\n            onChange={this.onChange.bind(this)}/>            \n\n          <div className=\"editbar\">\n            <span className=\"hint\">Supports styling with <a href=\"# \">Markdown</a></span>\n            <span className=\"buttons\">\n              <button\n                className=\"label nostyle\"\n                onClick={this.onDelete.bind(this)}>Delete description</button>\n\n              <button \n                className=\"icon nostyle\"\n                onClick={this.onSave.bind(this)}>&#xf00c;</button>\n\n              <button \n                className=\"icon nostyle\"\n                onClick={this.onCancel.bind(this)}>&#xf00d;</button>\n            </span>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  render() {\n    const editOnOpen = typeof this.props.content === 'boolean';\n\n    if (editOnOpen)\n      document.addEventListener('keydown', this.onKeydown, false);\n\n    const content = editOnOpen ? '' : \n      (this.state.modifiedContent ? this.state.modifiedContent : this.props.content);\n\n    return (this.state.editing || editOnOpen) ? this.renderEdit(content) : this.renderView(content);\n  }\n\n}\n","import React, { Component } from 'react';\n\nimport Avatar from './Avatar.jsx';\n\nexport default class IdentityInfo extends Component {\n\n  formatURL(url) {\n    return url.replace(/^https?:\\/\\//i, '');\n  }\n\n  render() {\n    const dataAvailable = \n      this.props.account && \n      this.props.account.username &&\n      this.props.account.member_since;\n      \n    return (\n      <div className=\"identity\">\n        <div className=\"user\">\n          <Avatar username={dataAvailable && this.props.account.username} />\n\n          <h1>\n            { dataAvailable ?\n                ((this.props.account.real_name) ? \n                  this.props.account.real_name : this.props.account.username) :\n\n                (<span className=\"placeholder\" />) }\n          </h1>\n\n          <p className=\"member-since\">\n            { dataAvailable ?\n              <React.Fragment>\n                Joined on { new Intl.DateTimeFormat('en-GB', {\n                  year : 'numeric',\n                  month: 'short',\n                  day  : '2-digit'\n                }).format(new Date(this.props.account.member_since)) }\n              </React.Fragment> : <span className=\"placeholder\" />\n            }\n          </p>\n        </div>\n\n        <div className=\"user-extended\">\n          { dataAvailable && this.props.account.bio &&\n            <p className=\"bio\">{this.props.account.bio}</p> }\n\n          { dataAvailable && this.props.account.website && \n            <p className=\"homepage\">\n              <a href={this.props.account.website}>{this.formatURL(this.props.account.website)}</a>\n            </p>\n          }\n        </div>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport { Bar, BarChart, CartesianGrid, XAxis } from 'recharts';\nimport NumberFormat from 'react-number-format';\n\nconst LINE_STYLE = {\n  stroke: '#c2c2c2', \n  strokeWidth:1\n}\n\nconst AXIS_STYLE = {\n  fontSize:\"12px\",\n  color:\"#3f3f3f\"\n}\n\nconst WEEK = 3600000 * 24 * 7; // A week in milliseconds\n\nconst tickFormatter = (tick) => new Intl.DateTimeFormat('en-GB', {\n  month: 'short'\n}).format(new Date(tick));\n\nexport default class ActivityHistory extends Component {\n\n  /** Helper that generates an empty time series of N buckets with value 0 */\n  createEmptySeries(n, toTimestamp) {\n    const empty = new Array(n);\n    empty.fill(0); // Needs to contain *something* for .reduce to work\n\n    const timestamps = empty.reduce((arr, _) => {\n      const last = arr[arr.length - 1];\n      arr.push(last - WEEK);\n      return arr;\n    }, [ toTimestamp - WEEK ]).reverse();\n\n    return timestamps.map(timestamp => {\n      return { timestamp: timestamp, value: 0 };\n    });\n  }\n\n  padTimeseries(t) {\n    const toTime = t.length > 0 ? t[0].timestamp : new Date().getTime();\n    const padding = this.createEmptySeries(19 - t.length, toTime);\n    return padding.concat(t);\n  }\n\n  computeChart() {\n    // Data comes as ISO strings - convert\n    const timeseries = this.props.stats.over_time.map(t => {\n      return { timestamp: Date.parse(t.date), value: t.value };\n    });\n\n    if (timeseries.length < 20) {\n      return this.padTimeseries(timeseries);\n    } else {\n      return timeseries;\n    }\n  }\n\n  render() {\n    return (\n      <div className={this.props.className ? \n        `activity-widget ${this.props.className}` : \"activity-widget\"}>\n\n        <h2>Activity \n          {this.props.stats && \n            <span className=\"count\">\n              <NumberFormat \n                displayType=\"text\"\n                value={this.props.stats.total_contributions}\n                thousandSeparator={true} /> edits\n            </span>\n          }\n        </h2>\n\n        {this.props.stats &&\n          <BarChart \n            width={this.props.width} \n            height={this.props.height} \n            barCategoryGap={1.5}\n            data={this.computeChart()} >\n\n            <CartesianGrid \n              strokeDasharray=\"3\" \n              horizontal={false}/>\n\n            <XAxis \n              type=\"number\"\n              dataKey=\"timestamp\"\n\n              axisLine={LINE_STYLE} \n\n              tick={AXIS_STYLE}\n              tickSize={4}\n              tickCount={6}\n              tickLine={LINE_STYLE}\n              tickFormatter={tickFormatter}\n\n              height={20}\n              domain={['dataMin', 'dataMax']}\n              padding={{ left: 5, right: 5 }} />\n\n            <Bar \n              dataKey=\"value\" \n              fill={this.props.fill} />\n\n          </BarChart>\n        }\n      </div>\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport axios from 'axios';\n\nimport Avatar from './Avatar.jsx';\n\nexport default class TopCollaborators extends Component {\n\n  state = {\n    collaborators: null\n  }\n\n  componentWillReceiveProps() {\n    this.fetchCollaborators();\n  }\n\n  fetchCollaborators() {\n    if (this.props.username && !this.state.collaborators)\n      axios\n        .get(`/api/account/${this.props.username}/collaborators`)\n        .then(result => this.setState({ collaborators: result.data }));\n  }\n\n  render() {\n    const { collaborators } = this.state;\n    return (\n      <React.Fragment>\n        {collaborators && collaborators.length > 0 &&\n          <div className={this.props.className ? `collaborator-list ${this.props.className}` : 'collaborator-list'}>\n            <h2>{this.props.title}</h2>\n            <ul>\n              {this.state.collaborators.map(user => \n                <li key={user.username}>\n                  <a href={`/${user.username}`} title={user.username}>\n                    <Avatar username={user.username} />\n                  </a>\n                </li>\n              )}\n            </ul>\n          </div>\n        }\n      </React.Fragment>\n    )\n  }\n\n}","import { Component } from 'react';\nimport { Columns } from '../Columns';\n\nexport default class BaseRowComponent extends Component {\n\n  constructor(props) {\n    super(props);\n    this.updateTotalRowSpan(props);\n  }\n\n  componentWillReceiveProps(next) {\n    this.updateTotalRowSpan(next);\n  }\n\n  /** Updates total unit width requirement for current row layout **/\n  updateTotalRowSpan(props) {\n    this._totalSpan = props.columns.reduce((total, field) => total + Columns.getSpan(field), 0);\n  }\n\n  getWidth(field) {\n    const span = Columns.getSpan(field);\n    return span / this._totalSpan;\n  }\n  \n}","import React from 'react';\nimport NumberFormat from 'react-number-format';\nimport TimeAgo from 'react-timeago';\nimport Icons from './TypeIcons';\nimport BaseRowComponent from './BaseRowComponent';\n\n/** Formatting rules for possible field types **/\nconst FORMATTERS = {\n  language: language => \n    language.toUpperCase(),\n\n  uploaded_at: datetime => \n    new Intl.DateTimeFormat('en-GB', {\n      year : 'numeric',\n      month: 'short',\n      day  : '2-digit'\n    }).format(new Date(datetime)),\n  \n  last_edit_at: datetime => \n    <TimeAgo date={datetime} />,\n\n  my_last_edit_at: datetime => \n    <TimeAgo date={datetime} />,\n  \n    public_visibility: (visibility) => {\n    if (visibility === 'PUBLIC') \n      return ( <span className=\"icon\" title=\"Open to anyone\">&#xf09c;</span> );\n    else if (visibility === 'WITH_LINK')\n      return ( <span className=\"icon\" title=\"Open to anyone with the link\">&#xf0c1;</span> );\n    else \n      return ( <span className=\"icon\" title=\"Private\">&#xf023;</span> );\n  },\n\n  access_level: level => {\n    if (level === 'ADMIN')\n      return ( <span className=\"icon\" title=\"ADMIN\">&#xf0ad;</span> );\n    else if (level === 'WRITE')\n      return ( <span className=\"icon\" title=\"WRITE\">&#xf040;</span> );\n    else\n      return ( <span className=\"icon\" title=\"READ\">&#xf06e;</span> );\n  },\n\n  annotations: annotations =>\n    <NumberFormat \n      displayType=\"text\"\n      value={annotations}\n      thousandSeparator={true} />,\n\n  my_annotations: annotations =>\n    <NumberFormat \n      displayType=\"text\"\n      value={annotations}\n      thousandSeparator={true} />,\n  \n  status_ratio: ratio => {\n    const total = ratio.verified + ratio.unverified + ratio.not_identifiable;\n    const pctGreen = ratio.verified / total * 100;\n    const pctYellow = ratio.not_identifiable / total * 100;\n\n    const labels = {\n      'verified': 'verified',\n      'unverified': 'unverified',\n      'not_identifiable': 'flagged'\n    }\n\n    const tooltip = ['verified', 'unverified', 'not_identifiable'].reduce((tooltip, next) => {\n      const count = ratio[next];\n      if (count === 0)\n        return tooltip;\n      else\n        return `${tooltip} ${count} ${labels[next]},`;\n    }, '').slice(0, -1);\n\n    return (\n      <span className=\"bar\" title={tooltip}>\n        <span className=\"verified\" style={{ width: `${pctGreen}%` }} />\n        <span className=\"not_identifiable\" style={{ width: `${pctYellow}%` }} />\n      </span>\n    )\n  },\n\n  cloned_from: clonedFrom =>\n    <span className=\"cloned-from\">\n      <span>{clonedFrom.username}</span> / <span>{clonedFrom.id}</span>\n    </span>,\n\n  has_clones: hasClones =>\n    <span className=\"has-clones\">{hasClones}</span>\n\n};\n\n/** Rules for aggregate fields **/\nconst AGGREGATE_FIELDS = {\n  agg_document: (item) => (item.author) ?\n                            `${item.author}, ${item.title}` : item.title\n};\n\nexport default class DocumentRow extends BaseRowComponent {\n\n  createAggregateField(url, field) {\n    return (\n      <a \n        key={field}\n        href={url} \n        className={field.substring(4)}\n        style={{ width: `${100 * super.getWidth(field)}%` }}>\n\n        {AGGREGATE_FIELDS[field](this.props.item)}\n      </a>\n    )\n  }\n\n  createField(url, field) {\n    const formatter = FORMATTERS[field];\n\n    const value = this.props.item[field] !== undefined ? \n      (formatter ? formatter(this.props.item[field]) : this.props.item[field]) :\n      ''; // empty value\n\n    return (\n      <a \n        key={field}\n        href={url}\n        className={field}\n        style={{ width: `${100 * super.getWidth(field)}%` }}>{value}</a>\n    )\n  }\n\n  render() {\n    const type = this.props.item.filetypes[0];\n    const url = `document/${this.props.item.id}/part/1/edit`;\n\n    return (\n      <div\n        className={`row${(this.props.selected) ? ' selected' : ''}`}\n        style={this.props.style}\n        onClick={this.props.onClick} >\n        \n        { this.props.columns.map(field => field.startsWith('agg_') ? \n          this.createAggregateField(url, field) : this.createField(url, field)) }\n\n        <span className={`type icon ${type}`}>\n          <img src={`/assets/images/${Icons.get(type)}`} alt={`icon type ${type}`} />\n        </span>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nexport default class FolderRow extends Component {\n\n  state = { \n    title: this.props.item.title,\n    editable: false\n  }\n\n  componentWillReceiveProps(next) {\n    this.setState({ \n      title: next.item.title,\n      editable: false\n    });\n  }\n\n  makeEditable = (evt) => {\n    this.setState({ editable: true },\n      () => this._input.select());\n\n    evt.preventDefault();\n    evt.stopPropagation();\n  }\n\n  onChange = (evt) => {\n    this.setState({ title: evt.target.value });\n  }\n\n  onKeyPress = (evt) => {\n    if (evt.which === 13) {\n      this.setState({ editable: false}, \n        () => this.props.onRename(this.props.item, this.state.title));\n    }\n  }\n\n  render() {\n    return (\n      <a\n        href={`#${this.props.item.id}`} \n        style={this.props.style}\n        className={`row folder${(this.props.selected) ? ' selected' : ''}`}\n        onClick={this.props.onClick}>\n\n        <span className=\"folder-title\">\n          { this.state.editable ? \n            <input \n              ref={i => this._input = i}\n              value={this.state.title}\n              onClick={this.makeEditable}\n              onChange={this.onChange}\n              onKeyDown={this.onKeyPress} />\n          : <span\n              className=\"editable\" \n              onClick={this.makeEditable} >{this.state.title}</span> }\n        </span>\n\n        <span className=\"type icon\">&#xf07b;</span>\n      </a>\n    )\n  }\n\n}\n","import React from 'react';\nimport BaseRowComponent from './BaseRowComponent';\nimport { HEADER_NAMES } from '../Columns';\n\nexport default class HeaderRow extends BaseRowComponent {\n\n  render() {\n    return (\n      <div className=\"column-labels\">\n        {this.props.columns.map(field =>\n          <span\n            key={field}\n            style={{ width: `${100 * super.getWidth(field)}%` }}\n            className={`label ${field}`}\n            onClick={this.props.onSort.bind(this, field)}>\n            <span className=\"inner-wrapper\">\n              <span className=\"inner\">\n                {HEADER_NAMES[field] || field}\n              </span>\n              {this.props.sortColumn === field &&\n                <span className=\"sort icon\">\n                  <span className=\"inner\">\n                    {(this.props.sortAsc) ? '\\ue688' : '\\ue682' }\n                  </span>\n                </span>\n              }\n            </span>\n          </span>\n        )}\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport { SortableContainer, SortableElement } from 'react-sortable-hoc';\nimport { HEADER_NAMES } from '../Columns.js';\n\nconst SortableItem = SortableElement(({ label }) =>\n  <div className=\"card\">{label}</div>\n);\n\nconst SortableList = SortableContainer(({ items }) =>\n  <div className=\"column-order\">\n    {items.map((item, idx) => (\n      <SortableItem key={`card-${idx}`} index={idx} label={HEADER_NAMES[item]} />\n    ))}\n  </div>\n);\n\nexport default class ColumnOrder extends Component {\n\n  render() {\n    return (\n      <SortableList\n        items={this.props.items}\n        onSortEnd={e => this.props.onSortEnd(e.oldIndex, e.newIndex)} />\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport { arrayMove } from 'react-sortable-hoc';\nimport Modal from '../../../Modal';\nimport ColumnOrder from './ColumnOrder';\nimport { COLUMNS, HEADER_NAMES } from '../Columns';\n\nexport default class PreferencesModal extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      columns: props.columns.slice(0)\n    }\n  }\n\n  componentWillReceiveProps(next) {\n    if (next.columns !== this.props.columns)\n      this.setState({ columns: next.columns.slice(0) });\n  }\n\n  /** Computes a map (fieldname -> checked) from the current columns state **/\n  getCheckboxStates(props) {\n    const states = {};\n\n    COLUMNS.forEach(field => {\n      const isChecked = this.state.columns.includes(field);\n      states[field] = isChecked;\n    });\n\n    return states;\n  }\n\n  /** Sets visibility for all rows to the given boolean value **/\n  setAllRows(checked) {\n    const checkAll = () => {\n      const toAppend = \n        COLUMNS.filter(field => !this.state.columns.includes(field));\n\n      this.setState({ columns: this.state.columns.concat(toAppend) });\n    };\n\n    const uncheckAll = () => {\n      this.setState({ columns: [] });\n    };\n\n    if (checked) \n      checkAll();\n    else\n      uncheckAll();\n  }\n\n  /**\n   * Clicking 'ALL' either checks all boxes or - if all are currently\n   * checked, unchecks them.\n   */\n  onClickAll() {\n    const allRowsChecked = COLUMNS.length === this.state.columns.length;\n    if (allRowsChecked)\n      this.setAllRows(false);\n    else\n      this.setAllRows(true);\n  }\n\n  /** Toggles the checkbox with the given name **/\n  toggleOne(name) {\n    this.setState(prev => {\n      const idx = prev.columns.indexOf(name);\n      if (idx < 0)\n        prev.columns.push(name);\n      else\n        prev.columns.splice(idx, 1);        \n    \n      return prev;\n    });\n  }\n\n  onSort(oldIndex, newIndex) {\n    this.setState({\n      columns: arrayMove(this.state.columns, oldIndex, newIndex)\n    });\n  }\n\n  render() {\n    // Helper to create a single checkbox + label row\n    const createRow = field =>\n      <li key={field}>\n        <input\n          type=\"checkbox\"\n          id={field}\n          name={field}\n          checked={this.state.columns.includes(field)}\n          onChange={this.toggleOne.bind(this, field)} />\n        <label htmlFor={field}>{HEADER_NAMES[field]}</label>\n      </li>\n\n    return (\n      <Modal\n        className=\"preferences\"\n        title=\"Configure Columns\"\n        onClose={this.props.onCancel}>\n\n        <div className=\"scroll-pane\">\n          <div className=\"selected-columns\">\n            <button\n              className=\"all nostyle\"\n              onClick={this.onClickAll.bind(this)}>All</button>\n            <ul>\n              { COLUMNS.map(createRow) }\n            </ul>\n          </div>\n\n          <ColumnOrder\n            items={this.state.columns} \n            onSortEnd={this.onSort.bind(this)} />\n        </div>\n\n        <div className=\"buttons\">\n          <button\n            className=\"btn\"\n            onClick={this.props.onSave.bind(this, this.state.columns)}>Save</button>\n\n          <button \n            className=\"btn outline\"\n            onClick={this.props.onCancel}>Cancel</button>\n        </div>\n      </Modal>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport { AutoSizer, List } from 'react-virtualized';\nimport Dropzone from 'react-dropzone'\nimport DocumentRow from './rows/DocumentRow';\nimport FiledropHint from '../FiledropHint';\nimport FolderRow from './rows/FolderRow';\nimport HeaderRow from './rows/HeaderRow';\nimport PreferencesModal from  './preferences/PreferencesModal';\n\nexport default class TablePane extends Component {\n\n  state = {\n    drag: false,\n    tablePreferencesOpen: false,\n  }\n\n  rowRenderer() {\n    return ((args) => {\n      const item = this.props.items[args.index];\n      const selected = this.props.selection && \n        this.props.selection.includes(item);\n\n      return (item.type === 'FOLDER') ?\n        <FolderRow \n          key={args.key} \n          style={args.style} \n          item={item} \n          selected={selected}\n          onClick={e => this.onRowClick(e, item, args.index)} \n          onRename={this.props.onRenameFolder} /> :\n\n        <DocumentRow\n          key={args.key}\n          style={args.style}\n          columns={this.props.config.columns}\n          item={item}\n          selected={selected}\n          onClick={e => this.onRowClick(e, item, args.index)} />\n    });\n  }\n\n  onRowClick(evt, item, idx) {\n    const selection = this.props.selection && \n      this.props.selection.handleClick(evt, item, idx, this.props.items);    \n      \n    if (selection)\n      this.props.onSelect(selection);\n  }\n\n  showPreferences = visible => {\n    this.setState({ tablePreferencesOpen: visible });\n  }\n\n  onSavePreferences = columns => {\n    this.setState({ tablePreferencesOpen: false });\n    this.props.onChangeColumnConfig(columns);\n  }\n\n  sortBy = field => {\n    const asc = this.props.config.sorting.by === field ? \n      ! this.props.config.sorting.asc : true;\n    this.props.onSort({ by: field, asc: asc });\n  }\n\n  onDrag = active => {\n    this.setState({ drag: active });\n  }\n\n  onDrop = (files, _, evt) => {\n    const url = evt.dataTransfer.getData('URL');\n\n    const hostname = url ? (() => {\n      const a = document.createElement('a');\n      a.href = url;\n      return a.hostname;\n    })() : null;\n\n    this.setState({ drag: false });\n\n    if (files.length > 0)\n      this.props.onDropFiles(files);\n    else if (url && hostname !== window.location.hostname) // Require external link\n      this.props.onDropSourceURL(url);\n  }\n\n  render() {\n    const tablePane =\n      <div className=\"documents-pane table-pane\">\n        <AutoSizer>\n          {({ height, width }) => (\n            <List\n              className=\"virtualized-list\"\n              width={width}\n              height={height}\n              rowCount={this.props.items.length}\n              rowHeight={47}\n              rowRenderer={this.rowRenderer()} />\n          )}\n        </AutoSizer>\n\n        { this.state.drag && \n          <FiledropHint /> }\n        \n        { this.props.busy &&\n           <div className=\"busy-mask\" /> }\n      </div>\n\n    return (\n      <React.Fragment>\n        <div className=\"documents-table-header\">\n          <HeaderRow \n            columns={this.props.config.columns} \n            sortColumn={this.props.config.sorting.by} \n            sortAsc={this.props.config.sorting.asc} \n            onSort={this.sortBy} />\n\n          <button\n            className=\"column-options-btn nostyle icon\"\n            onClick={() => this.showPreferences(true)} >&#xf141;</button>\n        </div>\n\n        { this.props.enableFiledrop ?\n          <Dropzone\n            className=\"dropzone\"\n            disableClick={true}\n            onDragEnter={() => this.onDrag(true)}\n            onDragLeave={() => this.onDrag(false)}\n            onDrop={this.onDrop}>\n            { tablePane }\n          </Dropzone> : tablePane\n        }\n\n        { this.state.tablePreferencesOpen &&\n          <PreferencesModal\n            columns={this.props.config.columns}\n            onCancel={() => this.showPreferences(false)} \n            onSave={this.onSavePreferences} />\n        }\n      </React.Fragment>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nexport default class Document extends Component {\n\n  render() {\n    const type = this.props.filetypes[0]; // TODO make more clever in the future\n    const isStacked = this.props.fileCount > 1;\n\n    return (\n      <a href={`document/${this.props.id}/part/1/edit`}\n        className={`cell${(this.props.selected) ? ' selected' : ''}`}\n        onClick={this.props.onClick} >\n        \n        <div className=\"inner\">\n          <div className={`item-wrapper${isStacked ? ' stacked' : ''}`}>\n            { isStacked && <div className=\"stack\" /> }\n            <div className={`document ${type}`}>\n              <div className=\"label\">\n                {this.props.title}\n              </div>\n            </div>\n          </div>\n        </div>\n      </a>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nexport default class Folder extends Component {\n\n  render() {\n    return (\n      <a href={`#${this.props.id}`} \n        className={`cell${(this.props.selected) ? ' selected' : ''}`}\n        onClick={this.props.onClick}>\n\n        <div className=\"inner\">\n          <div className=\"item-wrapper\">\n            <div className=\"folder\">\n              <div className=\"label\">\n                {this.props.title}\n              </div>\n            </div>\n          </div>\n        </div>\n      </a>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport Dropzone from 'react-dropzone'\nimport { AutoSizer, List } from 'react-virtualized';\nimport Document from './Document';\nimport Folder from './Folder';\nimport FiledropHint from '../FiledropHint';\n\nconst TILE_SIZE = 192;\n\n/**\n * Using the following example:\n *\n * https://stackoverflow.com/questions/46368305/how-to-make-a-list-grid-with-a-responsive-number-of-columns-using-react-virtuali\n * http://plnkr.co/edit/zjCwNeRZ7XtmFp1PDBsc?p=preview\n */\nexport default class GridPane extends Component {\n\n  state = {\n    drag: false\n  }\n\n  onTileClick(evt, item, idx) {\n    const selection = \n      this.props.selection && this.props.selection.handleClick(evt, item, idx, this.props.items);    \n\n    if (selection)\n      this.props.onSelect(selection);\n  }\n\n  rowRenderer(itemsPerRow) {\n    return (args => {\n      const fromIndex = args.index * itemsPerRow;\n      const toIndex = Math.min(fromIndex + itemsPerRow, this.props.items.length);\n      const itemsInRow = toIndex - fromIndex;\n\n      const renderedItems = new Array(itemsInRow).fill(undefined).map((_, rowIdx) => {\n        const idx = rowIdx + fromIndex;\n        const item = this.props.items[idx];\n        const selected = this.props.selection && this.props.selection.includes(item);\n\n        return (item.type === 'FOLDER') ?\n            <Folder\n              key={idx} \n              id={item.id}\n              title={item.title} \n              selected={selected}\n              onClick={e => this.onTileClick(e, item, idx)} /> :\n            \n            <Document\n              key={idx}\n              id={item.id}\n              title={item.title}\n              filetypes={item.filetypes}\n              fileCount={item.file_count}\n              selected={selected}\n              onClick={e => this.onTileClick(e, item, idx)} />\n      });\n\n      if (itemsInRow < itemsPerRow) { // Add dummies to preserve grid layout\n        renderedItems.push(new Array(itemsPerRow - itemsInRow).fill(undefined).map((_, idx) =>\n          <div className=\"cell dummy\" key={`dummy-${idx}`} />\n        ))\n      }\n\n      return (\n        <div\n          key={args.key}\n          style={args.style}\n          className=\"row\">\n          {renderedItems}\n        </div>\n      )\n    });\n  }\n\n  onDrag = (active) => {\n    this.setState({ drag: active });\n  }\n\n  onDrop = (files, _, evt) => {\n    const url = evt.dataTransfer.getData('URL');\n\n    this.setState({ drag: false });\n\n    if (files.length > 0) this.props.onDropFiles(files);\n    else if (url) this.props.onDropSourceURL(url);\n  }\n\n  render() {\n    const gridPane =\n      <AutoSizer>\n        {({ height, width }) => {\n          const itemsPerRow = Math.floor(width / TILE_SIZE);\n          const rowCount = Math.ceil(this.props.items.length / itemsPerRow);\n\n          return (\n            <List\n              className=\"virtualized-grid\"\n              width={width}\n              height={height}\n              rowCount={rowCount}\n              rowHeight={TILE_SIZE}\n              rowRenderer={this.rowRenderer(itemsPerRow)} />\n          )\n        }}\n      </AutoSizer>\n\n    return (\n      <React.Fragment>\n        <div className=\"documents-pane grid-pane\">\n          {this.props.disableFiledrop ? gridPane :\n            <Dropzone\n              className=\"dropzone\"\n              disableClick={true}\n              onDragEnter={() => this.onDrag(true)}\n              onDragLeave={() => this.onDrag(false)}\n              onDrop={this.onDrop}>\n\n              {gridPane}\n\n            </Dropzone>\n          }\n\n          { this.state.drag && <FiledropHint /> }\n        </div>\n      </React.Fragment>\n    )\n  }\n\n}\n"],"sourceRoot":""}